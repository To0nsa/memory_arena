<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>memory_arena: /home/toonsa/myProjects/memoryArena/srcs/core/arena_resize.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">memory_arena
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">/home/toonsa/myProjects/memoryArena/srcs/core/arena_resize.c</div></div>
</div><!--header-->
<div class="contents">
<p>Dynamically grow the arena's memory buffer to accommodate more data.</p>
<p>Dynamically grow the arena's memory buffer to accommodate more data.This function expands the size of the arenaâ€™s backing buffer to ensure that at least <code>required_size</code> bytes can be allocated on top of the current usage. It follows a growth policy defined by <code>arena-&gt;grow_cb</code>, or defaults to <code>default_grow_cb</code> if none is provided.</p>
<p>Growth is allowed only if:</p><ul>
<li>The arena is not <code>NULL</code>.</li>
<li><code>arena-&gt;owns_buffer</code> and <code>arena-&gt;can_grow</code> are <code>true</code>.</li>
<li>The resulting size does not overflow <code>SIZE_MAX</code>.</li>
</ul>
<p>On success:</p><ul>
<li>The arena buffer is reallocated to a larger size.</li>
<li>Internal stats are updated, including the <code>reallocations</code> counter and <code>growth_history</code>.</li>
<li>The function returns <code>true</code>.</li>
</ul>
<p>On failure:</p><ul>
<li>An appropriate error is reported via <code>arena_report_error</code>.</li>
<li>The function returns <code>false</code> without modifying the buffer.</li>
</ul>
<p>This function is thread-safe and acquires the arena lock during growth.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the <code><a class="el" href="namespace_3globalScope_4.html#structt__arena" title="The main memory arena structure used for fast allocation.">t_arena</a></code> to grow. </td></tr>
    <tr><td class="paramname">required_size</td><td>Additional bytes needed beyond current usage.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if growth succeeded, <code>false</code> otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If <code>required_size</code> is <code>0</code>, the function returns <code>true</code> without making changes.</dd>
<dd>
This function is normally called internally by <code><a class="el" href="arena_8h.html#a1def00c6156e8df19f0a1af7cd6f26dd">arena_alloc()</a></code> or <code><a class="el" href="arena_8h.html#a6c647c686994ff6f760d3590696c0976">arena_realloc_last()</a></code>. Users may call it directly to reserve memory in advance, but doing so is optional and rarely necessary.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arena__internal.html#ga627d4fdc46e225dccde0388ae40d04de" title="Default growth policy callback for arena resizing.">default_grow_cb</a> </dd>
<dd>
<a class="el" href="group__arena__resize__internal.html#ga4d80b5a3e6b0f4f15be8e871759bbca5" title="Validate whether the arena is allowed to grow for a given request.">arena_grow_validate</a> </dd>
<dd>
<a class="el" href="group__arena__resize__internal.html#gacf88b84bcca00ad988303735c64c05ab" title="Compute the new size for the arena based on the growth policy.">arena_grow_compute_new_size</a> </dd>
<dd>
<a class="el" href="group__arena__resize__internal.html#ga2c41abb420264a89db3a977a23d0a86c" title="Reallocate the arena&#39;s buffer to a new size.">arena_grow_realloc_buffer</a></dd></dl>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="arena_8h.html">arena.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Create an arena with an initial size of 128 bytes</span></div>
<div class="line">    <a id="_a0" name="_a0"></a><a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena = <a id="a1" name="a1"></a><a class="code hl_function" href="arena_8h.html#ad623b3dfc5761c29d44f78c58821c932">arena_create</a>(128, <span class="keyword">true</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (!arena)</div>
<div class="line">    {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Failed to create arena\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Manually grow the arena to ensure space for an additional 1024 bytes</span></div>
<div class="line">    <span class="keywordflow">if</span> (!<a id="a2" name="a2"></a><a class="code hl_function" href="arena_8h.html#a223081ace38b33a46cc1ed0eaadf867f">arena_grow</a>(arena, 1024))</div>
<div class="line">    {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Arena growth failed\n&quot;</span>);</div>
<div class="line">        <a id="a3" name="a3"></a><a class="code hl_function" href="arena_8h.html#a7821a62eaf6d9f982322e49eaf6153e8">arena_delete</a>(&amp;arena);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Arena successfully grown to %zu bytes\n&quot;</span>, arena-&gt;size);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Proceed with allocations as needed</span></div>
<div class="line">    <span class="keywordtype">void</span>* ptr = <a id="a4" name="a4"></a><a class="code hl_function" href="arena_8h.html#a1def00c6156e8df19f0a1af7cd6f26dd">arena_alloc</a>(arena, 512);</div>
<div class="line">    <span class="keywordflow">if</span> (!ptr)</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Allocation failed\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Cleanup</span></div>
<div class="line">    <a class="code hl_function" href="arena_8h.html#a7821a62eaf6d9f982322e49eaf6153e8">arena_delete</a>(&amp;arena);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aarena_8h_html"><div class="ttname"><a href="arena_8h.html">arena.h</a></div><div class="ttdoc">Core public API for the Arena memory allocator.</div></div>
<div class="ttc" id="aarena_8h_html_a1def00c6156e8df19f0a1af7cd6f26dd"><div class="ttname"><a href="arena_8h.html#a1def00c6156e8df19f0a1af7cd6f26dd">arena_alloc</a></div><div class="ttdeci">void * arena_alloc(t_arena *arena, size_t size)</div><div class="ttdef"><b>Definition</b> <a href="arena__alloc_8c_source.html#l00112">arena_alloc.c:112</a></div></div>
<div class="ttc" id="aarena_8h_html_a223081ace38b33a46cc1ed0eaadf867f"><div class="ttname"><a href="arena_8h.html#a223081ace38b33a46cc1ed0eaadf867f">arena_grow</a></div><div class="ttdeci">bool arena_grow(t_arena *arena, size_t required_size)</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00142">arena_resize.c:142</a></div></div>
<div class="ttc" id="aarena_8h_html_a7821a62eaf6d9f982322e49eaf6153e8"><div class="ttname"><a href="arena_8h.html#a7821a62eaf6d9f982322e49eaf6153e8">arena_delete</a></div><div class="ttdeci">void arena_delete(t_arena **arena)</div><div class="ttdef"><b>Definition</b> <a href="arena__cleanup_8c_source.html#l00148">arena_cleanup.c:148</a></div></div>
<div class="ttc" id="aarena_8h_html_ad623b3dfc5761c29d44f78c58821c932"><div class="ttname"><a href="arena_8h.html#ad623b3dfc5761c29d44f78c58821c932">arena_create</a></div><div class="ttdeci">t_arena * arena_create(size_t size, bool allow_grow)</div><div class="ttdef"><b>Definition</b> <a href="arena__create_8c_source.html#l00111">arena_create.c:111</a></div></div>
<div class="ttc" id="anamespace_3globalScope_4_html_structt__arena"><div class="ttname"><a href="namespace_3globalScope_4.html#structt__arena">t_arena</a></div><div class="ttdoc">The main memory arena structure used for fast allocation.</div></div>
</div><!-- fragment --><div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="arena_8h.html">arena.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * INTERNAL HELPERS DEFINITIONS</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span>   <a id="a5" name="a5"></a><a class="code hl_function" href="group__arena__resize__internal.html#ga29d65ae92e063e9ae4b37940fe3c0963">arena_should_grow</a>(<span class="keyword">const</span> <a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena);</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>   <a id="a6" name="a6"></a><a class="code hl_function" href="group__arena__resize__internal.html#gad63a48e38ca9296f79b12d8dee576fda">arena_record_growth</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> old_size);</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span>   <a id="a7" name="a7"></a><a class="code hl_function" href="group__arena__resize__internal.html#ga4d80b5a3e6b0f4f15be8e871759bbca5">arena_grow_validate</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> required_size);</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a id="a8" name="a8"></a><a class="code hl_function" href="group__arena__resize__internal.html#gacf88b84bcca00ad988303735c64c05ab">arena_grow_compute_new_size</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> required_size);</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span>   <a id="a9" name="a9"></a><a class="code hl_function" href="group__arena__resize__internal.html#ga2c41abb420264a89db3a977a23d0a86c">arena_grow_realloc_buffer</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> new_size, <span class="keywordtype">size_t</span> old_size);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a id="a10" name="a10"></a><a class="code hl_function" href="group__arena__resize__internal.html#ga770aa7d0f606aecdb9c6858d6d04bc6e">arena_can_shrink</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> new_size);</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a id="a11" name="a11"></a><a class="code hl_function" href="group__arena__resize__internal.html#ga4857922d4fafe26b957397c9f6857f41">arena_shrink_validate</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> new_size);</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a id="a12" name="a12"></a><a class="code hl_function" href="group__arena__resize__internal.html#ga648ef2e28b422c3ea050e1a0c8d16f82">arena_shrink_apply</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> new_size);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span>   <a id="a13" name="a13"></a><a class="code hl_function" href="group__arena__resize__internal.html#ga6abbceb590e3634b0832e8ae5a34f249">should_attempt_shrink</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena);</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span>   <a id="a14" name="a14"></a><a class="code hl_function" href="group__arena__resize__internal.html#gae22777b5f27566fdb53247d3b34423cc">arena_should_maybe_shrink</a>(<span class="keywordtype">size_t</span> <a id="a15" name="a15"></a><a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>, <span class="keywordtype">size_t</span> size);</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a id="a16" name="a16"></a><a class="code hl_function" href="group__arena__resize__internal.html#ga11682f2046cdc92c45cc6ac544a0576b">arena_shrink_target</a>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * PUBLIC API</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> <a class="code hl_function" href="arena_8h.html#a223081ace38b33a46cc1ed0eaadf867f">arena_grow</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> required_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!arena)</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (required_size == 0)</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">    <a id="a17" name="a17"></a><a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>(arena);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_function" href="group__arena__resize__internal.html#ga4d80b5a3e6b0f4f15be8e871759bbca5">arena_grow_validate</a>(arena, required_size))</div>
<div class="line">    {</div>
<div class="line">        <a id="a18" name="a18"></a><a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> old_size = arena-&gt;size;</div>
<div class="line">    <span class="keywordtype">size_t</span> new_size = <a class="code hl_function" href="group__arena__resize__internal.html#gacf88b84bcca00ad988303735c64c05ab">arena_grow_compute_new_size</a>(arena, required_size);</div>
<div class="line">    <span class="keywordflow">if</span> (new_size == 0)</div>
<div class="line">    {</div>
<div class="line">        <a id="a19" name="a19"></a><a class="code hl_function" href="group__arena__debug.html#gad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;arena_grow failed: computed size invalid&quot;</span>);</div>
<div class="line">        <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (new_size &gt; (<span class="keywordtype">size_t</span>)(1ULL &lt;&lt; 32)) <span class="comment">// 4GiB</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__arena__debug.html#gad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;arena_grow rejected size: %zu&quot;</span>, new_size);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">bool</span> success = <a class="code hl_function" href="group__arena__resize__internal.html#ga2c41abb420264a89db3a977a23d0a86c">arena_grow_realloc_buffer</a>(arena, new_size, old_size);</div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">    <span class="keywordflow">return</span> success;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a id="a20" name="a20"></a><a class="code hl_function" href="arena_8h.html#ac09092abf5d001bd4ff11af16fed346d">arena_shrink</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> new_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!arena)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>(arena);</div>
<div class="line">    <a id="a21" name="a21"></a><a class="code hl_define" href="arena__debug_8h.html#af130b4bbc0466511d1efc74412d5ef3c">ARENA_CHECK</a>(arena);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> ok = <a class="code hl_function" href="group__arena__resize__internal.html#ga4857922d4fafe26b957397c9f6857f41">arena_shrink_validate</a>(arena, new_size) &amp;&amp; <a class="code hl_function" href="group__arena__resize__internal.html#ga648ef2e28b422c3ea050e1a0c8d16f82">arena_shrink_apply</a>(arena, new_size);</div>
<div class="line"> </div>
<div class="line">    (void) ok;</div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> <a id="a22" name="a22"></a><a class="code hl_function" href="arena_8h.html#a43195b93eadf7cbd1155836c887ac54d">arena_might_shrink</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_function" href="group__arena__resize__internal.html#ga6abbceb590e3634b0832e8ae5a34f249">should_attempt_shrink</a>(arena))</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>(arena);</div>
<div class="line">    <a class="code hl_define" href="arena__debug_8h.html#af130b4bbc0466511d1efc74412d5ef3c">ARENA_CHECK</a>(arena);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a> = arena-&gt;offset;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">size_t</span> size = arena-&gt;size;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_function" href="group__arena__resize__internal.html#gae22777b5f27566fdb53247d3b34423cc">arena_should_maybe_shrink</a>(<a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>, size))</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> target = <a class="code hl_function" href="group__arena__resize__internal.html#ga11682f2046cdc92c45cc6ac544a0576b">arena_shrink_target</a>(<a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (target &lt; size)</div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_function" href="arena_8h.html#ac09092abf5d001bd4ff11af16fed346d">arena_shrink</a>(arena, target);</div>
<div class="line">            <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * INTERNAL HELPERS IMPLEMENTATION</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__arena__resize__internal.html#ga29d65ae92e063e9ae4b37940fe3c0963">arena_should_grow</a>(<span class="keyword">const</span> <a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">bool</span> owns = atomic_load_explicit(&amp;arena-&gt;owns_buffer, memory_order_acquire);</div>
<div class="line">    <span class="keywordtype">bool</span> grow = atomic_load_explicit(&amp;arena-&gt;can_grow, memory_order_acquire);</div>
<div class="line">    <span class="keywordflow">return</span> owns &amp;&amp; grow;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__arena__resize__internal.html#gad63a48e38ca9296f79b12d8dee576fda">arena_record_growth</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> old_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span>* temp = realloc(arena-&gt;stats.growth_history, <span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) * (arena-&gt;stats.growth_history_count + 1));</div>
<div class="line">    <span class="keywordflow">if</span> (temp)</div>
<div class="line">    {</div>
<div class="line">        arena-&gt;stats.growth_history                                      = temp;</div>
<div class="line">        arena-&gt;stats.growth_history[arena-&gt;stats.growth_history_count++] = old_size;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__arena__resize__internal.html#ga4d80b5a3e6b0f4f15be8e871759bbca5">arena_grow_validate</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> required_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_function" href="group__arena__resize__internal.html#ga29d65ae92e063e9ae4b37940fe3c0963">arena_should_grow</a>(arena))</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_function" href="group__arena__debug.html#gad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;arena_grow failed: growth not allowed&quot;</span>), <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (required_size &gt; SIZE_MAX - arena-&gt;offset)</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_function" href="group__arena__debug.html#gad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;arena_grow failed: size overflow&quot;</span>), <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="group__arena__resize__internal.html#gacf88b84bcca00ad988303735c64c05ab">arena_grow_compute_new_size</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> required_size)</div>
<div class="line">{</div>
<div class="line">    <a id="a23" name="a23"></a><a class="code hl_typedef" href="arena_8h.html#abb1be1f36e6a52d5673bdd0e98cfb7f1">arena_grow_callback</a> cb        = arena-&gt;grow_cb ? arena-&gt;grow_cb : <a id="a24" name="a24"></a><a class="code hl_function" href="group__arena__internal.html#ga627d4fdc46e225dccde0388ae40d04de">default_grow_cb</a>;</div>
<div class="line">    <span class="keywordtype">size_t</span>              requested = arena-&gt;offset + required_size;</div>
<div class="line">    <span class="keywordtype">size_t</span>              new_size  = cb(arena-&gt;size, required_size);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (new_size &lt; requested)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    <span class="keywordflow">if</span> (new_size &gt; SIZE_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> new_size;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__arena__resize__internal.html#ga2c41abb420264a89db3a977a23d0a86c">arena_grow_realloc_buffer</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> new_size, <span class="keywordtype">size_t</span> old_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">void</span>* new_buf = realloc(arena-&gt;buffer, new_size);</div>
<div class="line">    <span class="keywordflow">if</span> (!new_buf)</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_function" href="group__arena__debug.html#gad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;arena_grow failed: realloc failed&quot;</span>), <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    arena-&gt;buffer = (uint8_t*) new_buf;</div>
<div class="line">    arena-&gt;size   = new_size;</div>
<div class="line">    arena-&gt;stats.reallocations++;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__arena__resize__internal.html#gad63a48e38ca9296f79b12d8dee576fda">arena_record_growth</a>(arena, old_size);</div>
<div class="line"> </div>
<div class="line">    <a id="a25" name="a25"></a><a class="code hl_define" href="arena__debug_8h.html#abf0e7a681c28a08824cb678ec3f9a6c6">ALOG</a>(<span class="stringliteral">&quot;[arena_grow] Arena %p grown from %zu to %zu bytes\n&quot;</span>, (<span class="keywordtype">void</span>*) arena, old_size, new_size);</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__arena__resize__internal.html#ga770aa7d0f606aecdb9c6858d6d04bc6e">arena_can_shrink</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> new_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!arena)</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> owns = atomic_load_explicit(&amp;arena-&gt;owns_buffer, memory_order_acquire);</div>
<div class="line">    <span class="keywordtype">bool</span> grow = atomic_load_explicit(&amp;arena-&gt;can_grow, memory_order_acquire);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!owns || !grow)</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (new_size &lt; arena-&gt;offset)</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (new_size == arena-&gt;offset)</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> shrink_ratio = (double) new_size / (<span class="keywordtype">double</span>) arena-&gt;size;</div>
<div class="line">    <span class="keywordflow">return</span> shrink_ratio &lt;= <a id="a26" name="a26"></a><a class="code hl_define" href="arena__config_8h.html#af980329701af53ca4e64074d249a43c3">ARENA_MIN_SHRINK_RATIO</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__arena__resize__internal.html#ga4857922d4fafe26b957397c9f6857f41">arena_shrink_validate</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> new_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!arena)</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_function" href="group__arena__resize__internal.html#ga770aa7d0f606aecdb9c6858d6d04bc6e">arena_can_shrink</a>(arena, new_size))</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__arena__resize__internal.html#ga648ef2e28b422c3ea050e1a0c8d16f82">arena_shrink_apply</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena, <span class="keywordtype">size_t</span> new_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">void</span>* new_buf = realloc(arena-&gt;buffer, new_size);</div>
<div class="line">    <span class="keywordflow">if</span> (!new_buf)</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    arena-&gt;buffer = (uint8_t*) new_buf;</div>
<div class="line">    arena-&gt;size   = new_size;</div>
<div class="line">    arena-&gt;stats.shrinks++;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="arena__debug_8h.html#abf0e7a681c28a08824cb678ec3f9a6c6">ALOG</a>(<span class="stringliteral">&quot;[arena_shrink] Arena %p shrunk to %zu bytes\n&quot;</span>, (<span class="keywordtype">void</span>*) arena, new_size);</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__arena__resize__internal.html#ga6abbceb590e3634b0832e8ae5a34f249">should_attempt_shrink</a>(<a class="code hl_struct" href="namespace_3globalScope_4.html#structt__arena">t_arena</a>* arena)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!arena)</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> atomic_load_explicit(&amp;arena-&gt;can_grow, memory_order_acquire);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__arena__resize__internal.html#gae22777b5f27566fdb53247d3b34423cc">arena_should_maybe_shrink</a>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>, <span class="keywordtype">size_t</span> size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (size == 0)</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> ratio = (double) <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a> / (<span class="keywordtype">double</span>) size;</div>
<div class="line">    <span class="keywordflow">return</span> ratio &lt; <a class="code hl_define" href="arena__config_8h.html#af980329701af53ca4e64074d249a43c3">ARENA_MIN_SHRINK_RATIO</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="group__arena__resize__internal.html#ga11682f2046cdc92c45cc6ac544a0576b">arena_shrink_target</a>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a> + <a id="a27" name="a27"></a><a class="code hl_define" href="arena__config_8h.html#aced1b6e804e7cc6cdcc93894dcee11ee">ARENA_SHRINK_PADDING</a>;</div>
<div class="line">}</div>
<div class="ttc" id="aarena_8h_html_a43195b93eadf7cbd1155836c887ac54d"><div class="ttname"><a href="arena_8h.html#a43195b93eadf7cbd1155836c887ac54d">arena_might_shrink</a></div><div class="ttdeci">bool arena_might_shrink(t_arena *arena)</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00385">arena_resize.c:385</a></div></div>
<div class="ttc" id="aarena_8h_html_abb1be1f36e6a52d5673bdd0e98cfb7f1"><div class="ttname"><a href="arena_8h.html#abb1be1f36e6a52d5673bdd0e98cfb7f1">arena_grow_callback</a></div><div class="ttdeci">size_t(* arena_grow_callback)(size_t current_size, size_t requested_size)</div><div class="ttdef"><b>Definition</b> <a href="arena_8h_source.html#l00079">arena.h:79</a></div></div>
<div class="ttc" id="aarena_8h_html_ac09092abf5d001bd4ff11af16fed346d"><div class="ttname"><a href="arena_8h.html#ac09092abf5d001bd4ff11af16fed346d">arena_shrink</a></div><div class="ttdeci">void arena_shrink(t_arena *arena, size_t new_size)</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00267">arena_resize.c:267</a></div></div>
<div class="ttc" id="aarena__config_8h_html_aced1b6e804e7cc6cdcc93894dcee11ee"><div class="ttname"><a href="arena__config_8h.html#aced1b6e804e7cc6cdcc93894dcee11ee">ARENA_SHRINK_PADDING</a></div><div class="ttdeci">#define ARENA_SHRINK_PADDING</div><div class="ttdoc">Extra padding when computing shrink sizes.</div><div class="ttdef"><b>Definition</b> <a href="arena__config_8h_source.html#l00021">arena_config.h:21</a></div></div>
<div class="ttc" id="aarena__config_8h_html_af980329701af53ca4e64074d249a43c3"><div class="ttname"><a href="arena__config_8h.html#af980329701af53ca4e64074d249a43c3">ARENA_MIN_SHRINK_RATIO</a></div><div class="ttdeci">#define ARENA_MIN_SHRINK_RATIO</div><div class="ttdoc">Shrink threshold: offset &lt; ratio * size.</div><div class="ttdef"><b>Definition</b> <a href="arena__config_8h_source.html#l00016">arena_config.h:16</a></div></div>
<div class="ttc" id="aarena__debug_8h_html_abf0e7a681c28a08824cb678ec3f9a6c6"><div class="ttname"><a href="arena__debug_8h.html#abf0e7a681c28a08824cb678ec3f9a6c6">ALOG</a></div><div class="ttdeci">#define ALOG(...)</div><div class="ttdoc">Debug logging macro (enabled only if ARENA_DEBUG_LOG is set).</div><div class="ttdef"><b>Definition</b> <a href="arena__debug_8h_source.html#l00173">arena_debug.h:173</a></div></div>
<div class="ttc" id="aarena__debug_8h_html_af130b4bbc0466511d1efc74412d5ef3c"><div class="ttname"><a href="arena__debug_8h.html#af130b4bbc0466511d1efc74412d5ef3c">ARENA_CHECK</a></div><div class="ttdeci">#define ARENA_CHECK(arena)</div><div class="ttdef"><b>Definition</b> <a href="arena__debug_8h_source.html#l00158">arena_debug.h:158</a></div></div>
<div class="ttc" id="aarena__internal_8h_html_a22d9551decc1373f55ceb93bcd8b27a3"><div class="ttname"><a href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a></div><div class="ttdeci">#define ARENA_UNLOCK(arena)</div><div class="ttdef"><b>Definition</b> <a href="arena__internal_8h_source.html#l00062">arena_internal.h:62</a></div></div>
<div class="ttc" id="aarena__internal_8h_html_a5aca30bebc88f9c38377ff61521b3796"><div class="ttname"><a href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a></div><div class="ttdeci">#define ARENA_LOCK(arena)</div><div class="ttdoc">Acquire the mutex lock if thread safety is enabled.</div><div class="ttdef"><b>Definition</b> <a href="arena__internal_8h_source.html#l00061">arena_internal.h:61</a></div></div>
<div class="ttc" id="aarena__io_8h_html_ae8cc011bf3ee2d3c19743095ffc0f7a5"><div class="ttname"><a href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a></div><div class="ttdeci">size_t used</div><div class="ttdoc">Number of bytes used in the arena buffer.</div><div class="ttdef"><b>Definition</b> <a href="arena__io_8h_source.html#l00002">arena_io.h:2</a></div></div>
<div class="ttc" id="agroup__arena__debug_html_gad19e051bc49dc6b6dcda0f31561e222d"><div class="ttname"><a href="group__arena__debug.html#gad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a></div><div class="ttdeci">void arena_report_error(t_arena *arena, const char *fmt,...)</div><div class="ttdoc">Report an error from an arena using its configured error callback.</div><div class="ttdef"><b>Definition</b> <a href="arena__debug_8c_source.html#l00253">arena_debug.c:253</a></div></div>
<div class="ttc" id="agroup__arena__internal_html_ga627d4fdc46e225dccde0388ae40d04de"><div class="ttname"><a href="group__arena__internal.html#ga627d4fdc46e225dccde0388ae40d04de">default_grow_cb</a></div><div class="ttdeci">size_t default_grow_cb(size_t current_size, size_t requested_size)</div><div class="ttdoc">Default growth policy callback for arena resizing.</div><div class="ttdef"><b>Definition</b> <a href="arena__internal_8c_source.html#l00078">arena_internal.c:78</a></div></div>
<div class="ttc" id="agroup__arena__resize__internal_html_ga11682f2046cdc92c45cc6ac544a0576b"><div class="ttname"><a href="group__arena__resize__internal.html#ga11682f2046cdc92c45cc6ac544a0576b">arena_shrink_target</a></div><div class="ttdeci">static size_t arena_shrink_target(size_t used)</div><div class="ttdoc">Compute the target buffer size for a shrink operation.</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00819">arena_resize.c:819</a></div></div>
<div class="ttc" id="agroup__arena__resize__internal_html_ga29d65ae92e063e9ae4b37940fe3c0963"><div class="ttname"><a href="group__arena__resize__internal.html#ga29d65ae92e063e9ae4b37940fe3c0963">arena_should_grow</a></div><div class="ttdeci">static bool arena_should_grow(const t_arena *arena)</div><div class="ttdoc">Check whether the arena is allowed to grow.</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00441">arena_resize.c:441</a></div></div>
<div class="ttc" id="agroup__arena__resize__internal_html_ga2c41abb420264a89db3a977a23d0a86c"><div class="ttname"><a href="group__arena__resize__internal.html#ga2c41abb420264a89db3a977a23d0a86c">arena_grow_realloc_buffer</a></div><div class="ttdeci">static bool arena_grow_realloc_buffer(t_arena *arena, size_t new_size, size_t old_size)</div><div class="ttdoc">Reallocate the arena's buffer to a new size.</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00594">arena_resize.c:594</a></div></div>
<div class="ttc" id="agroup__arena__resize__internal_html_ga4857922d4fafe26b957397c9f6857f41"><div class="ttname"><a href="group__arena__resize__internal.html#ga4857922d4fafe26b957397c9f6857f41">arena_shrink_validate</a></div><div class="ttdeci">static bool arena_shrink_validate(t_arena *arena, size_t new_size)</div><div class="ttdoc">Validate whether an arena can be safely shrunk to a new size.</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00681">arena_resize.c:681</a></div></div>
<div class="ttc" id="agroup__arena__resize__internal_html_ga4d80b5a3e6b0f4f15be8e871759bbca5"><div class="ttname"><a href="group__arena__resize__internal.html#ga4d80b5a3e6b0f4f15be8e871759bbca5">arena_grow_validate</a></div><div class="ttdeci">static bool arena_grow_validate(t_arena *arena, size_t required_size)</div><div class="ttdoc">Validate whether the arena is allowed to grow for a given request.</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00513">arena_resize.c:513</a></div></div>
<div class="ttc" id="agroup__arena__resize__internal_html_ga648ef2e28b422c3ea050e1a0c8d16f82"><div class="ttname"><a href="group__arena__resize__internal.html#ga648ef2e28b422c3ea050e1a0c8d16f82">arena_shrink_apply</a></div><div class="ttdeci">static bool arena_shrink_apply(t_arena *arena, size_t new_size)</div><div class="ttdoc">Apply the memory shrink operation to an arena's buffer.</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00720">arena_resize.c:720</a></div></div>
<div class="ttc" id="agroup__arena__resize__internal_html_ga6abbceb590e3634b0832e8ae5a34f249"><div class="ttname"><a href="group__arena__resize__internal.html#ga6abbceb590e3634b0832e8ae5a34f249">should_attempt_shrink</a></div><div class="ttdeci">static bool should_attempt_shrink(t_arena *arena)</div><div class="ttdoc">Determine whether the arena is eligible for dynamic shrinking.</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00755">arena_resize.c:755</a></div></div>
<div class="ttc" id="agroup__arena__resize__internal_html_ga770aa7d0f606aecdb9c6858d6d04bc6e"><div class="ttname"><a href="group__arena__resize__internal.html#ga770aa7d0f606aecdb9c6858d6d04bc6e">arena_can_shrink</a></div><div class="ttdeci">static bool arena_can_shrink(t_arena *arena, size_t new_size)</div><div class="ttdoc">Determine whether the arena is eligible for shrinking to a smaller size.</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00640">arena_resize.c:640</a></div></div>
<div class="ttc" id="agroup__arena__resize__internal_html_gacf88b84bcca00ad988303735c64c05ab"><div class="ttname"><a href="group__arena__resize__internal.html#gacf88b84bcca00ad988303735c64c05ab">arena_grow_compute_new_size</a></div><div class="ttdeci">static size_t arena_grow_compute_new_size(t_arena *arena, size_t required_size)</div><div class="ttdoc">Compute the new size for the arena based on the growth policy.</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00553">arena_resize.c:553</a></div></div>
<div class="ttc" id="agroup__arena__resize__internal_html_gad63a48e38ca9296f79b12d8dee576fda"><div class="ttname"><a href="group__arena__resize__internal.html#gad63a48e38ca9296f79b12d8dee576fda">arena_record_growth</a></div><div class="ttdeci">static void arena_record_growth(t_arena *arena, size_t old_size)</div><div class="ttdoc">Record the previous size of the arena in the growth history.</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00473">arena_resize.c:473</a></div></div>
<div class="ttc" id="agroup__arena__resize__internal_html_gae22777b5f27566fdb53247d3b34423cc"><div class="ttname"><a href="group__arena__resize__internal.html#gae22777b5f27566fdb53247d3b34423cc">arena_should_maybe_shrink</a></div><div class="ttdeci">static bool arena_should_maybe_shrink(size_t used, size_t size)</div><div class="ttdoc">Decide whether the arena buffer should be shrunk based on usage ratio.</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00788">arena_resize.c:788</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
