<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>memory_arena: /home/toonsa/myProjects/memoryArena/srcs/core/arena_state.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">memory_arena
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">/home/toonsa/myProjects/memoryArena/srcs/core/arena_state.c</div></div>
</div><!--header-->
<div class="contents">
<p>Get the number of bytes currently used in the arena.</p>
<p>Get the number of bytes currently used in the arena.This function returns the current offset of the arena, which represents the total number of bytes that have been allocated (but not necessarily in use). It does not include alignment padding or internal fragmentation.</p>
<p>This is useful for:</p><ul>
<li>Measuring memory usage.</li>
<li>Debugging or profiling arena-based systems.</li>
<li>Saving the state for later rollback via <code><a class="el" href="arena__state_8c.html#abc6eabbcdd6ff5c3c187cd782644dfff">arena_mark()</a></code> and <code><a class="el" href="arena__state_8c.html#a43f443882d11939468a2c6a33bdb88af">arena_pop()</a></code>.</li>
</ul>
<p>Thread-safe: this function locks the arena before accessing internal state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes currently used, or <code>0</code> if <code>arena</code> is <code>NULL</code>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="arena__state_8c.html#a366e9bd9ae716c21f10df35c34a50ccf">arena_remaining</a> </dd>
<dd>
<a class="el" href="arena__state_8c.html#a6e261f2520d969c662266ce7f7a0390c">arena_peak</a> </dd>
<dd>
<a class="el" href="arena__state_8c.html#abc6eabbcdd6ff5c3c187cd782644dfff">arena_mark</a></dd></dl>
<div class="fragment"><div class="line"><a id="_a0" name="_a0"></a><a class="code hl_struct" href="structt__arena.html">t_arena</a>* arena = <a id="a1" name="a1"></a><a class="code hl_function" href="arena_8h.html#ad623b3dfc5761c29d44f78c58821c932">arena_create</a>(1024, <span class="keyword">true</span>);</div>
<div class="line"><a id="a2" name="a2"></a><a class="code hl_function" href="arena_8h.html#a1def00c6156e8df19f0a1af7cd6f26dd">arena_alloc</a>(arena, 128);</div>
<div class="line"><a class="code hl_function" href="arena_8h.html#a1def00c6156e8df19f0a1af7cd6f26dd">arena_alloc</a>(arena, 64);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">size_t</span> <a id="a3" name="a3"></a><a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a> = <a id="a4" name="a4"></a><a class="code hl_function" href="arena_8h.html#a34c7c4eb11cde7b892e1d7c0cd20c886">arena_used</a>(arena);</div>
<div class="line">printf(<span class="stringliteral">&quot;Used bytes: %zu\n&quot;</span>, <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>); <span class="comment">// Output: 192 (if no padding), or more if aligned</span></div>
<div class="line"> </div>
<div class="line"><a id="a5" name="a5"></a><a class="code hl_function" href="arena_8h.html#a7821a62eaf6d9f982322e49eaf6153e8">arena_delete</a>(&amp;arena);</div>
<div class="ttc" id="aarena_8h_html_a1def00c6156e8df19f0a1af7cd6f26dd"><div class="ttname"><a href="arena_8h.html#a1def00c6156e8df19f0a1af7cd6f26dd">arena_alloc</a></div><div class="ttdeci">void * arena_alloc(t_arena *arena, size_t size)</div><div class="ttdef"><b>Definition</b> arena_alloc.c:112</div></div>
<div class="ttc" id="aarena_8h_html_a34c7c4eb11cde7b892e1d7c0cd20c886"><div class="ttname"><a href="arena_8h.html#a34c7c4eb11cde7b892e1d7c0cd20c886">arena_used</a></div><div class="ttdeci">size_t arena_used(t_arena *arena)</div><div class="ttdef"><b>Definition</b> arena_state.c:73</div></div>
<div class="ttc" id="aarena_8h_html_a7821a62eaf6d9f982322e49eaf6153e8"><div class="ttname"><a href="arena_8h.html#a7821a62eaf6d9f982322e49eaf6153e8">arena_delete</a></div><div class="ttdeci">void arena_delete(t_arena **arena)</div><div class="ttdef"><b>Definition</b> arena_cleanup.c:148</div></div>
<div class="ttc" id="aarena_8h_html_ad623b3dfc5761c29d44f78c58821c932"><div class="ttname"><a href="arena_8h.html#ad623b3dfc5761c29d44f78c58821c932">arena_create</a></div><div class="ttdeci">t_arena * arena_create(size_t size, bool allow_grow)</div><div class="ttdef"><b>Definition</b> arena_create.c:111</div></div>
<div class="ttc" id="aarena__io_8h_html_ae8cc011bf3ee2d3c19743095ffc0f7a5"><div class="ttname"><a href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a></div><div class="ttdeci">size_t used</div><div class="ttdoc">Number of bytes used in the arena buffer.</div><div class="ttdef"><b>Definition</b> arena_io.h:2</div></div>
<div class="ttc" id="astructt__arena_html"><div class="ttname"><a href="structt__arena.html">t_arena</a></div><div class="ttdoc">The main memory arena structure used for fast allocation.</div></div>
</div><!-- fragment --><div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="arena_8h.html">arena.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">size_t</span> <a class="code hl_function" href="arena_8h.html#a34c7c4eb11cde7b892e1d7c0cd20c886">arena_used</a>(<a class="code hl_struct" href="structt__arena.html">t_arena</a>* arena)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!arena)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <a id="a6" name="a6"></a><a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>(arena);</div>
<div class="line">    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a> = arena-&gt;offset;</div>
<div class="line">    <a id="a7" name="a7"></a><a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">size_t</span> <a id="a8" name="a8"></a><a class="code hl_function" href="arena_8h.html#a366e9bd9ae716c21f10df35c34a50ccf">arena_remaining</a>(<a class="code hl_struct" href="structt__arena.html">t_arena</a>* arena)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!arena)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>(arena);</div>
<div class="line">    <span class="keywordtype">size_t</span> remaining = arena-&gt;size - arena-&gt;offset;</div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">    <span class="keywordflow">return</span> remaining;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">size_t</span> <a id="a9" name="a9"></a><a class="code hl_function" href="arena_8h.html#a6e261f2520d969c662266ce7f7a0390c">arena_peak</a>(<a class="code hl_struct" href="structt__arena.html">t_arena</a>* arena)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!arena)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>(arena);</div>
<div class="line">    <span class="keywordtype">size_t</span> peak = arena-&gt;stats.peak_usage;</div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">    <span class="keywordflow">return</span> peak;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="arena_8h.html#ad7902c92dd6262f1f86cdb4086bd144b">t_arena_marker</a> <a id="a10" name="a10"></a><a class="code hl_function" href="arena_8h.html#abc6eabbcdd6ff5c3c187cd782644dfff">arena_mark</a>(<a class="code hl_struct" href="structt__arena.html">t_arena</a>* arena)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!arena)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>(arena);</div>
<div class="line">    <span class="keywordtype">size_t</span> offset = arena-&gt;offset;</div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">    <span class="keywordflow">return</span> offset;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a id="a11" name="a11"></a><a class="code hl_function" href="arena_8h.html#a43f443882d11939468a2c6a33bdb88af">arena_pop</a>(<a class="code hl_struct" href="structt__arena.html">t_arena</a>* arena, <a class="code hl_typedef" href="arena_8h.html#ad7902c92dd6262f1f86cdb4086bd144b">t_arena_marker</a> marker)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!arena)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>(arena);</div>
<div class="line">    <span class="keywordflow">if</span> (marker &gt; arena-&gt;offset)</div>
<div class="line">    {</div>
<div class="line">        <a id="a12" name="a12"></a><a class="code hl_function" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;arena_pop failed: invalid marker %zu (offset: %zu)&quot;</span>, marker, arena-&gt;offset);</div>
<div class="line">        <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a id="a13" name="a13"></a><a class="code hl_define" href="arena__debug_8h.html#a904e1da25faaab32ade91d8232c60364">arena_poison_memory</a>(arena-&gt;buffer + marker, arena-&gt;offset - marker);</div>
<div class="line">    arena-&gt;offset = marker;</div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a id="a14" name="a14"></a><a class="code hl_function" href="arena_8h.html#a1a2582ca5fb4e571ac150fbd77bd0d82">arena_reset</a>(<a class="code hl_struct" href="structt__arena.html">t_arena</a>* arena)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!arena)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>(arena);</div>
<div class="line">    <a id="a15" name="a15"></a><a class="code hl_define" href="arena__debug_8h.html#a45fe83c0004caeffb8724c787d022110">ARENA_ASSERT_VALID</a>(arena);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="arena__debug_8h.html#a904e1da25faaab32ade91d8232c60364">arena_poison_memory</a>(arena-&gt;buffer, arena-&gt;size);</div>
<div class="line">    arena-&gt;offset = 0;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line">}</div>
<div class="ttc" id="aarena_8h_html"><div class="ttname"><a href="arena_8h.html">arena.h</a></div><div class="ttdoc">Core public API for the Arena memory allocator.</div></div>
<div class="ttc" id="aarena_8h_html_a1a2582ca5fb4e571ac150fbd77bd0d82"><div class="ttname"><a href="arena_8h.html#a1a2582ca5fb4e571ac150fbd77bd0d82">arena_reset</a></div><div class="ttdeci">void arena_reset(t_arena *arena)</div><div class="ttdef"><b>Definition</b> arena_state.c:345</div></div>
<div class="ttc" id="aarena_8h_html_a366e9bd9ae716c21f10df35c34a50ccf"><div class="ttname"><a href="arena_8h.html#a366e9bd9ae716c21f10df35c34a50ccf">arena_remaining</a></div><div class="ttdeci">size_t arena_remaining(t_arena *arena)</div><div class="ttdef"><b>Definition</b> arena_state.c:122</div></div>
<div class="ttc" id="aarena_8h_html_a43f443882d11939468a2c6a33bdb88af"><div class="ttname"><a href="arena_8h.html#a43f443882d11939468a2c6a33bdb88af">arena_pop</a></div><div class="ttdeci">void arena_pop(t_arena *arena, t_arena_marker marker)</div><div class="ttdef"><b>Definition</b> arena_state.c:283</div></div>
<div class="ttc" id="aarena_8h_html_a6e261f2520d969c662266ce7f7a0390c"><div class="ttname"><a href="arena_8h.html#a6e261f2520d969c662266ce7f7a0390c">arena_peak</a></div><div class="ttdeci">size_t arena_peak(t_arena *arena)</div><div class="ttdef"><b>Definition</b> arena_state.c:175</div></div>
<div class="ttc" id="aarena_8h_html_abc6eabbcdd6ff5c3c187cd782644dfff"><div class="ttname"><a href="arena_8h.html#abc6eabbcdd6ff5c3c187cd782644dfff">arena_mark</a></div><div class="ttdeci">t_arena_marker arena_mark(t_arena *arena)</div><div class="ttdef"><b>Definition</b> arena_state.c:227</div></div>
<div class="ttc" id="aarena_8h_html_ad7902c92dd6262f1f86cdb4086bd144b"><div class="ttname"><a href="arena_8h.html#ad7902c92dd6262f1f86cdb4086bd144b">t_arena_marker</a></div><div class="ttdeci">size_t t_arena_marker</div><div class="ttdef"><b>Definition</b> arena.h:91</div></div>
<div class="ttc" id="aarena__debug_8h_html_a45fe83c0004caeffb8724c787d022110"><div class="ttname"><a href="arena__debug_8h.html#a45fe83c0004caeffb8724c787d022110">ARENA_ASSERT_VALID</a></div><div class="ttdeci">#define ARENA_ASSERT_VALID(arena)</div><div class="ttdef"><b>Definition</b> arena_debug.h:420</div></div>
<div class="ttc" id="aarena__debug_8h_html_a904e1da25faaab32ade91d8232c60364"><div class="ttname"><a href="arena__debug_8h.html#a904e1da25faaab32ade91d8232c60364">arena_poison_memory</a></div><div class="ttdeci">#define arena_poison_memory(ptr, size)</div><div class="ttdoc">No-op poison macro when poisoning is disabled.</div><div class="ttdef"><b>Definition</b> arena_debug.h:334</div></div>
<div class="ttc" id="aarena__debug_8h_html_ad19e051bc49dc6b6dcda0f31561e222d"><div class="ttname"><a href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a></div><div class="ttdeci">void arena_report_error(t_arena *arena, const char *fmt,...)</div><div class="ttdef"><b>Definition</b> arena_debug.c:253</div></div>
<div class="ttc" id="aarena__internal_8h_html_a22d9551decc1373f55ceb93bcd8b27a3"><div class="ttname"><a href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a></div><div class="ttdeci">#define ARENA_UNLOCK(arena)</div><div class="ttdef"><b>Definition</b> arena_internal.h:62</div></div>
<div class="ttc" id="aarena__internal_8h_html_a5aca30bebc88f9c38377ff61521b3796"><div class="ttname"><a href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a></div><div class="ttdeci">#define ARENA_LOCK(arena)</div><div class="ttdoc">Acquire the mutex lock if thread safety is enabled.</div><div class="ttdef"><b>Definition</b> arena_internal.h:61</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
