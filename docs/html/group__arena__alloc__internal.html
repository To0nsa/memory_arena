<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>memory_arena: Arena Allocation Internals</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">memory_arena
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Arena Allocation Internals<div class="ingroups"><a class="el" href="group__arena__internal.html">Internal Implementation</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Internal helpers for memory allocation logic.  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Arena Allocation Internals:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__arena__alloc__internal.png" border="0" usemap="#agroup____arena____alloc____internal" alt=""/></div>
<map name="agroup____arena____alloc____internal" id="agroup____arena____alloc____internal">
<area shape="rect" title="Internal helpers for memory allocation logic." alt="" coords="233,5,424,31"/>
<area shape="rect" href="group__arena__internal.html" title="Base group for internal implementation details." alt="" coords="5,5,185,31"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga133779294340b3b7b1353e5e41870855" id="r_ga133779294340b3b7b1353e5e41870855"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#ga133779294340b3b7b1353e5e41870855">arena_alloc_internal</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, size_t size, size_t alignment, const char *label)</td></tr>
<tr class="memdesc:ga133779294340b3b7b1353e5e41870855"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core internal allocator with alignment and labeling support.  <br /></td></tr>
<tr class="separator:ga133779294340b3b7b1353e5e41870855"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3a85314e0611147a92383d02d616bc1a" id="r_ga3a85314e0611147a92383d02d616bc1a"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#ga3a85314e0611147a92383d02d616bc1a">arena_alloc_validate_input</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, size_t size, size_t alignment, const char *label)</td></tr>
<tr class="memdesc:ga3a85314e0611147a92383d02d616bc1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate input parameters for arena allocation.  <br /></td></tr>
<tr class="separator:ga3a85314e0611147a92383d02d616bc1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2e295157296ca7e9d2450486f2e817e0" id="r_ga2e295157296ca7e9d2450486f2e817e0"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#ga2e295157296ca7e9d2450486f2e817e0">arena_calc_aligned_offset</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, size_t alignment)</td></tr>
<tr class="memdesc:ga2e295157296ca7e9d2450486f2e817e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the next aligned offset within the arena.  <br /></td></tr>
<tr class="separator:ga2e295157296ca7e9d2450486f2e817e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f9b8799f6f53e294ff5368b6cca60cf" id="r_ga6f9b8799f6f53e294ff5368b6cca60cf"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#ga6f9b8799f6f53e294ff5368b6cca60cf">arena_check_overflow</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, size_t size, const char *label)</td></tr>
<tr class="memdesc:ga6f9b8799f6f53e294ff5368b6cca60cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether an allocation would cause a size_t overflow.  <br /></td></tr>
<tr class="separator:ga6f9b8799f6f53e294ff5368b6cca60cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9f456348bfdf8040dd8d3fbf26bfd4fa" id="r_ga9f456348bfdf8040dd8d3fbf26bfd4fa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#ga9f456348bfdf8040dd8d3fbf26bfd4fa">arena_commit_allocation</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, size_t size, size_t wasted, size_t aligned_offset)</td></tr>
<tr class="memdesc:ga9f456348bfdf8040dd8d3fbf26bfd4fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update offset, peak usage, and statistics.  <br /></td></tr>
<tr class="separator:ga9f456348bfdf8040dd8d3fbf26bfd4fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeb6bc4f71524a7a594b0e248eb0dbda0" id="r_gaeb6bc4f71524a7a594b0e248eb0dbda0"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#gaeb6bc4f71524a7a594b0e248eb0dbda0">arena_ensure_capacity</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, size_t size, size_t alignment, const char *label, size_t *aligned_offset, size_t *wasted)</td></tr>
<tr class="memdesc:gaeb6bc4f71524a7a594b0e248eb0dbda0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure that the arena has enough space for a new allocation with alignment.  <br /></td></tr>
<tr class="separator:gaeb6bc4f71524a7a594b0e248eb0dbda0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f2b15d641638478af17012c9af5044e" id="r_ga8f2b15d641638478af17012c9af5044e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#ga8f2b15d641638478af17012c9af5044e">arena_invoke_allocation_hook</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, void *ptr, size_t size, size_t offset, size_t wasted, const char *label)</td></tr>
<tr class="memdesc:ga8f2b15d641638478af17012c9af5044e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Invoke the user-defined allocation hook, if registered.  <br /></td></tr>
<tr class="separator:ga8f2b15d641638478af17012c9af5044e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4860119335c3c686269e4912018ce72f" id="r_ga4860119335c3c686269e4912018ce72f"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#ga4860119335c3c686269e4912018ce72f">arena_is_being_destroyed</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, const char *label)</td></tr>
<tr class="memdesc:ga4860119335c3c686269e4912018ce72f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether the arena is currently being destroyed.  <br /></td></tr>
<tr class="separator:ga4860119335c3c686269e4912018ce72f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga59787ca32537e09f2b7bb6087540d35a" id="r_ga59787ca32537e09f2b7bb6087540d35a"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#ga59787ca32537e09f2b7bb6087540d35a">arena_realloc_validate</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, void *old_ptr, size_t new_size)</td></tr>
<tr class="memdesc:ga59787ca32537e09f2b7bb6087540d35a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate input arguments for <code>arena_realloc_last</code>.  <br /></td></tr>
<tr class="separator:ga59787ca32537e09f2b7bb6087540d35a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9c0ddb62aa03ce8395bf6937ebf2a766" id="r_ga9c0ddb62aa03ce8395bf6937ebf2a766"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#ga9c0ddb62aa03ce8395bf6937ebf2a766">arena_try_grow</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, size_t size, const char *label)</td></tr>
<tr class="memdesc:ga9c0ddb62aa03ce8395bf6937ebf2a766"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to grow the arena's buffer to satisfy an upcoming allocation.  <br /></td></tr>
<tr class="separator:ga9c0ddb62aa03ce8395bf6937ebf2a766"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac58e6becbc80f328dce1ad2ecf17c2f0" id="r_gac58e6becbc80f328dce1ad2ecf17c2f0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#gac58e6becbc80f328dce1ad2ecf17c2f0">arena_update_stats</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, size_t size, size_t wasted)</td></tr>
<tr class="memdesc:gac58e6becbc80f328dce1ad2ecf17c2f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update allocation statistics after a successful arena allocation.  <br /></td></tr>
<tr class="separator:gac58e6becbc80f328dce1ad2ecf17c2f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad3e406beb730e9664468c0ca3ba8ec3e" id="r_gad3e406beb730e9664468c0ca3ba8ec3e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#gad3e406beb730e9664468c0ca3ba8ec3e">arena_zero_if_needed</a> (void *ptr, size_t size, const char *label)</td></tr>
<tr class="memdesc:gad3e406beb730e9664468c0ca3ba8ec3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zero or poison a memory region depending on allocation label.  <br /></td></tr>
<tr class="separator:gad3e406beb730e9664468c0ca3ba8ec3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7344d4d188eb129d3d35a47a46569d1e" id="r_ga7344d4d188eb129d3d35a47a46569d1e"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#ga7344d4d188eb129d3d35a47a46569d1e">is_last_allocation</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, void *old_ptr, size_t old_size)</td></tr>
<tr class="memdesc:ga7344d4d188eb129d3d35a47a46569d1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if a given pointer corresponds to the most recent allocation.  <br /></td></tr>
<tr class="separator:ga7344d4d188eb129d3d35a47a46569d1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f5f39015c38a0eb93f501a0aac30904" id="r_ga5f5f39015c38a0eb93f501a0aac30904"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#ga5f5f39015c38a0eb93f501a0aac30904">realloc_fallback</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, void *old_ptr, size_t old_size, size_t new_size)</td></tr>
<tr class="memdesc:ga5f5f39015c38a0eb93f501a0aac30904"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a fallback reallocation by allocating new memory and copying data.  <br /></td></tr>
<tr class="separator:ga5f5f39015c38a0eb93f501a0aac30904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2d7433d074678a86dbeae84e99ac8f94" id="r_ga2d7433d074678a86dbeae84e99ac8f94"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#ga2d7433d074678a86dbeae84e99ac8f94">realloc_in_place</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, void *old_ptr, size_t old_size, size_t new_size)</td></tr>
<tr class="memdesc:ga2d7433d074678a86dbeae84e99ac8f94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to resize the last allocation in place.  <br /></td></tr>
<tr class="separator:ga2d7433d074678a86dbeae84e99ac8f94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf5e38e7a826283f488841979faec9f00" id="r_gaf5e38e7a826283f488841979faec9f00"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arena__alloc__internal.html#gaf5e38e7a826283f488841979faec9f00">update_realloc_stats</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, void *ptr, size_t new_size, size_t old_size, const char *label)</td></tr>
<tr class="memdesc:gaf5e38e7a826283f488841979faec9f00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update arena statistics after a successful reallocation.  <br /></td></tr>
<tr class="separator:gaf5e38e7a826283f488841979faec9f00"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Internal helpers for memory allocation logic. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga133779294340b3b7b1353e5e41870855" name="ga133779294340b3b7b1353e5e41870855"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga133779294340b3b7b1353e5e41870855">&#9670;&#160;</a></span>arena_alloc_internal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * arena_alloc_internal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__alloc_8c.html">arena_alloc.c</a>&gt;</code></p>

<p>Core internal allocator with alignment and labeling support. </p>
<p>This function performs the complete logic for allocating memory from an arena. It supports:</p><ul>
<li>Alignment-aware allocation.</li>
<li>Out-of-bounds detection and safe growth if enabled.</li>
<li>Labeling for diagnostics and debugging.</li>
<li>Allocation hooks for instrumentation.</li>
</ul>
<p>The flow is:</p><ol type="1">
<li>Validate input arguments (alignment, size, etc.).</li>
<li>Acquire the arena lock and perform consistency checks.</li>
<li>Ensure the arena is not being destroyed.</li>
<li>Check for arithmetic overflow.</li>
<li>Calculate aligned offset and check capacity.</li>
<li>Optionally grow the arena.</li>
<li>Commit the allocation (update offset and stats).</li>
<li>Zero the memory if requested via label.</li>
<li>Trigger the allocation hook if registered.</li>
<li>Return a pointer to the allocated memory.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>The arena from which to allocate. </td></tr>
    <tr><td class="paramname">size</td><td>The number of bytes to allocate. </td></tr>
    <tr><td class="paramname">alignment</td><td>The alignment in bytes (must be power of two). </td></tr>
    <tr><td class="paramname">label</td><td>A descriptive label for logging and debugging.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the allocated memory, or <code>NULL</code> on failure.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Use public wrappers like <code><a class="el" href="arena__alloc_8c.html#a1def00c6156e8df19f0a1af7cd6f26dd">arena_alloc()</a></code> or <code><a class="el" href="arena__alloc_8c.html#a3c9a2623dab46020e9d9462d48120261">arena_alloc_aligned()</a></code> for convenience. This function is not meant to be called directly by users.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="arena__alloc_8c.html#a1def00c6156e8df19f0a1af7cd6f26dd">arena_alloc</a> </dd>
<dd>
<a class="el" href="arena__alloc_8c.html#a3c9a2623dab46020e9d9462d48120261">arena_alloc_aligned</a> </dd>
<dd>
<a class="el" href="arena__alloc_8c.html#ad0e41d4f7cc6043cab06d317e13f298e">arena_alloc_labeled</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="arena__alloc_8c_source.html#l00721">721</a> of file <a class="el" href="arena__alloc_8c_source.html">arena_alloc.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  722</span>{</div>
<div class="line"><span class="lineno">  723</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="group__arena__alloc__internal.html#ga3a85314e0611147a92383d02d616bc1a">arena_alloc_validate_input</a>(arena, size, alignment, label))</div>
<div class="line"><span class="lineno">  724</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>    <a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>(arena);</div>
<div class="line"><span class="lineno">  727</span>    <a class="code hl_define" href="arena__debug_8h.html#af130b4bbc0466511d1efc74412d5ef3c">ARENA_CHECK</a>(arena);</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="group__arena__alloc__internal.html#ga4860119335c3c686269e4912018ce72f">arena_is_being_destroyed</a>(arena, label))</div>
<div class="line"><span class="lineno">  730</span>    {</div>
<div class="line"><span class="lineno">  731</span>        <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line"><span class="lineno">  732</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  733</span>    }</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="group__arena__alloc__internal.html#ga6f9b8799f6f53e294ff5368b6cca60cf">arena_check_overflow</a>(arena, size, label))</div>
<div class="line"><span class="lineno">  736</span>    {</div>
<div class="line"><span class="lineno">  737</span>        <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line"><span class="lineno">  738</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  739</span>    }</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>    <span class="keywordtype">size_t</span> aligned_offset = 0;</div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordtype">size_t</span> wasted         = 0;</div>
<div class="line"><span class="lineno">  743</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="group__arena__alloc__internal.html#gaeb6bc4f71524a7a594b0e248eb0dbda0">arena_ensure_capacity</a>(arena, size, alignment, label, &amp;aligned_offset, &amp;wasted))</div>
<div class="line"><span class="lineno">  744</span>    {</div>
<div class="line"><span class="lineno">  745</span>        arena-&gt;stats.failed_allocations++;</div>
<div class="line"><span class="lineno">  746</span>        <a class="code hl_function" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;%s failed: out of memory (requested: %zu)&quot;</span>, label, size);</div>
<div class="line"><span class="lineno">  747</span>        <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line"><span class="lineno">  748</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  749</span>    }</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>    <a class="code hl_function" href="group__arena__alloc__internal.html#ga9f456348bfdf8040dd8d3fbf26bfd4fa">arena_commit_allocation</a>(arena, size, wasted, aligned_offset);</div>
<div class="line"><span class="lineno">  752</span>    <span class="keywordtype">void</span>* result = arena-&gt;buffer + aligned_offset;</div>
<div class="line"><span class="lineno">  753</span>    <a class="code hl_function" href="group__arena__alloc__internal.html#gad3e406beb730e9664468c0ca3ba8ec3e">arena_zero_if_needed</a>(result, size, label);</div>
<div class="line"><span class="lineno">  754</span>    <a class="code hl_function" href="group__arena__alloc__internal.html#ga8f2b15d641638478af17012c9af5044e">arena_invoke_allocation_hook</a>(arena, result, size, aligned_offset, wasted, label);</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>    <a class="code hl_define" href="arena__debug_8h.html#abf0e7a681c28a08824cb678ec3f9a6c6">ALOG</a>(<span class="stringliteral">&quot;[arena] %s: Allocated %zu bytes @ offset %zu (arena %p)\n&quot;</span>, label, size, aligned_offset, (<span class="keywordtype">void</span>*) arena);</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>    <a class="code hl_define" href="arena__debug_8h.html#af130b4bbc0466511d1efc74412d5ef3c">ARENA_CHECK</a>(arena);</div>
<div class="line"><span class="lineno">  759</span>    <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line"><span class="lineno">  760</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  761</span>}</div>
<div class="ttc" id="aarena__debug_8h_html_abf0e7a681c28a08824cb678ec3f9a6c6"><div class="ttname"><a href="arena__debug_8h.html#abf0e7a681c28a08824cb678ec3f9a6c6">ALOG</a></div><div class="ttdeci">#define ALOG(...)</div><div class="ttdoc">Debug logging macro (enabled only if ARENA_DEBUG_LOG is set).</div><div class="ttdef"><b>Definition</b> <a href="arena__debug_8h_source.html#l00434">arena_debug.h:434</a></div></div>
<div class="ttc" id="aarena__debug_8h_html_ad19e051bc49dc6b6dcda0f31561e222d"><div class="ttname"><a href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a></div><div class="ttdeci">void arena_report_error(t_arena *arena, const char *fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="arena__debug_8c_source.html#l00253">arena_debug.c:253</a></div></div>
<div class="ttc" id="aarena__debug_8h_html_af130b4bbc0466511d1efc74412d5ef3c"><div class="ttname"><a href="arena__debug_8h.html#af130b4bbc0466511d1efc74412d5ef3c">ARENA_CHECK</a></div><div class="ttdeci">#define ARENA_CHECK(arena)</div><div class="ttdef"><b>Definition</b> <a href="arena__debug_8h_source.html#l00419">arena_debug.h:419</a></div></div>
<div class="ttc" id="aarena__internal_8h_html_a22d9551decc1373f55ceb93bcd8b27a3"><div class="ttname"><a href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a></div><div class="ttdeci">#define ARENA_UNLOCK(arena)</div><div class="ttdef"><b>Definition</b> <a href="arena__internal_8h_source.html#l00062">arena_internal.h:62</a></div></div>
<div class="ttc" id="aarena__internal_8h_html_a5aca30bebc88f9c38377ff61521b3796"><div class="ttname"><a href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a></div><div class="ttdeci">#define ARENA_LOCK(arena)</div><div class="ttdoc">Acquire the mutex lock if thread safety is enabled.</div><div class="ttdef"><b>Definition</b> <a href="arena__internal_8h_source.html#l00061">arena_internal.h:61</a></div></div>
<div class="ttc" id="agroup__arena__alloc__internal_html_ga3a85314e0611147a92383d02d616bc1a"><div class="ttname"><a href="group__arena__alloc__internal.html#ga3a85314e0611147a92383d02d616bc1a">arena_alloc_validate_input</a></div><div class="ttdeci">static bool arena_alloc_validate_input(t_arena *arena, size_t size, size_t alignment, const char *label)</div><div class="ttdoc">Validate input parameters for arena allocation.</div><div class="ttdef"><b>Definition</b> <a href="arena__alloc_8c_source.html#l00311">arena_alloc.c:311</a></div></div>
<div class="ttc" id="agroup__arena__alloc__internal_html_ga4860119335c3c686269e4912018ce72f"><div class="ttname"><a href="group__arena__alloc__internal.html#ga4860119335c3c686269e4912018ce72f">arena_is_being_destroyed</a></div><div class="ttdeci">static bool arena_is_being_destroyed(t_arena *arena, const char *label)</div><div class="ttdoc">Check whether the arena is currently being destroyed.</div><div class="ttdef"><b>Definition</b> <a href="arena__alloc_8c_source.html#l00356">arena_alloc.c:356</a></div></div>
<div class="ttc" id="agroup__arena__alloc__internal_html_ga6f9b8799f6f53e294ff5368b6cca60cf"><div class="ttname"><a href="group__arena__alloc__internal.html#ga6f9b8799f6f53e294ff5368b6cca60cf">arena_check_overflow</a></div><div class="ttdeci">static bool arena_check_overflow(t_arena *arena, size_t size, const char *label)</div><div class="ttdoc">Check whether an allocation would cause a size_t overflow.</div><div class="ttdef"><b>Definition</b> <a href="arena__alloc_8c_source.html#l00388">arena_alloc.c:388</a></div></div>
<div class="ttc" id="agroup__arena__alloc__internal_html_ga8f2b15d641638478af17012c9af5044e"><div class="ttname"><a href="group__arena__alloc__internal.html#ga8f2b15d641638478af17012c9af5044e">arena_invoke_allocation_hook</a></div><div class="ttdeci">static void arena_invoke_allocation_hook(t_arena *arena, void *ptr, size_t size, size_t offset, size_t wasted, const char *label)</div><div class="ttdoc">Invoke the user-defined allocation hook, if registered.</div><div class="ttdef"><b>Definition</b> <a href="arena__alloc_8c_source.html#l00672">arena_alloc.c:672</a></div></div>
<div class="ttc" id="agroup__arena__alloc__internal_html_ga9f456348bfdf8040dd8d3fbf26bfd4fa"><div class="ttname"><a href="group__arena__alloc__internal.html#ga9f456348bfdf8040dd8d3fbf26bfd4fa">arena_commit_allocation</a></div><div class="ttdeci">static void arena_commit_allocation(t_arena *arena, size_t size, size_t wasted, size_t aligned_offset)</div><div class="ttdoc">Update offset, peak usage, and statistics.</div><div class="ttdef"><b>Definition</b> <a href="arena__alloc_8c_source.html#l00593">arena_alloc.c:593</a></div></div>
<div class="ttc" id="agroup__arena__alloc__internal_html_gad3e406beb730e9664468c0ca3ba8ec3e"><div class="ttname"><a href="group__arena__alloc__internal.html#gad3e406beb730e9664468c0ca3ba8ec3e">arena_zero_if_needed</a></div><div class="ttdeci">static void arena_zero_if_needed(void *ptr, size_t size, const char *label)</div><div class="ttdoc">Zero or poison a memory region depending on allocation label.</div><div class="ttdef"><b>Definition</b> <a href="arena__alloc_8c_source.html#l00628">arena_alloc.c:628</a></div></div>
<div class="ttc" id="agroup__arena__alloc__internal_html_gaeb6bc4f71524a7a594b0e248eb0dbda0"><div class="ttname"><a href="group__arena__alloc__internal.html#gaeb6bc4f71524a7a594b0e248eb0dbda0">arena_ensure_capacity</a></div><div class="ttdeci">static bool arena_ensure_capacity(t_arena *arena, size_t size, size_t alignment, const char *label, size_t *aligned_offset, size_t *wasted)</div><div class="ttdoc">Ensure that the arena has enough space for a new allocation with alignment.</div><div class="ttdef"><b>Definition</b> <a href="arena__alloc_8c_source.html#l00503">arena_alloc.c:503</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__debug_8h_source.html#l00434">ALOG</a>, <a class="el" href="arena__alloc_8c_source.html#l00311">arena_alloc_validate_input()</a>, <a class="el" href="arena__debug_8h_source.html#l00419">ARENA_CHECK</a>, <a class="el" href="arena__alloc_8c_source.html#l00388">arena_check_overflow()</a>, <a class="el" href="arena__alloc_8c_source.html#l00593">arena_commit_allocation()</a>, <a class="el" href="arena__alloc_8c_source.html#l00503">arena_ensure_capacity()</a>, <a class="el" href="arena__alloc_8c_source.html#l00672">arena_invoke_allocation_hook()</a>, <a class="el" href="arena__alloc_8c_source.html#l00356">arena_is_being_destroyed()</a>, <a class="el" href="arena__internal_8h_source.html#l00061">ARENA_LOCK</a>, <a class="el" href="arena__debug_8c_source.html#l00253">arena_report_error()</a>, <a class="el" href="arena__internal_8h_source.html#l00062">ARENA_UNLOCK</a>, and <a class="el" href="arena__alloc_8c_source.html#l00628">arena_zero_if_needed()</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__alloc_8c_source.html#l00112">arena_alloc()</a>, <a class="el" href="arena__alloc_8c_source.html#l00167">arena_alloc_aligned()</a>, <a class="el" href="arena__alloc_8c_source.html#l00274">arena_alloc_aligned_labeled()</a>, <a class="el" href="arena__alloc_8c_source.html#l00217">arena_alloc_labeled()</a>, and <a class="el" href="arena__calloc_8c_source.html#l00267">arena_calloc_aligned_labeled()</a>.</p>

</div>
</div>
<a id="ga3a85314e0611147a92383d02d616bc1a" name="ga3a85314e0611147a92383d02d616bc1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3a85314e0611147a92383d02d616bc1a">&#9670;&#160;</a></span>arena_alloc_validate_input()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool arena_alloc_validate_input </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__alloc_8c.html">arena_alloc.c</a>&gt;</code></p>

<p>Validate input parameters for arena allocation. </p>
<p>This internal helper checks that all parameters passed to an arena allocation function are valid before proceeding. It performs the following checks:</p>
<ul>
<li>The <code>arena</code> pointer is not <code>NULL</code>.</li>
<li>The requested <code>size</code> is greater than zero.</li>
<li>The <code>alignment</code> is a non-zero power of two (required for valid memory alignment).</li>
</ul>
<p>If any of these checks fail, an appropriate error is reported using <code><a class="el" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error()</a></code> with a descriptive message and the provided label.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the <code><a class="el" href="structt__arena.html" title="The main memory arena structure used for fast allocation.">t_arena</a></code> to validate. </td></tr>
    <tr><td class="paramname">size</td><td>Size of the memory to allocate, in bytes. </td></tr>
    <tr><td class="paramname">alignment</td><td>Requested alignment of the memory block (must be power-of-two). </td></tr>
    <tr><td class="paramname">label</td><td>Name of the calling function, used in error messages.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if all inputs are valid, <code>false</code> otherwise.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arena__alloc__internal.html#ga133779294340b3b7b1353e5e41870855" title="Core internal allocator with alignment and labeling support.">arena_alloc_internal</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_alloc_8c-example.html#a4">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_alloc.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__alloc_8c_source.html#l00311">311</a> of file <a class="el" href="arena__alloc_8c_source.html">arena_alloc.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  312</span>{</div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordflow">if</span> (!arena)</div>
<div class="line"><span class="lineno">  314</span>    {</div>
<div class="line"><span class="lineno">  315</span>        <a class="code hl_function" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(NULL, <span class="stringliteral">&quot;%s failed: NULL arena&quot;</span>, label);</div>
<div class="line"><span class="lineno">  316</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  317</span>    }</div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordflow">if</span> (size == 0)</div>
<div class="line"><span class="lineno">  319</span>    {</div>
<div class="line"><span class="lineno">  320</span>        <a class="code hl_function" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;%s failed: zero-size allocation&quot;</span>, label);</div>
<div class="line"><span class="lineno">  321</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  322</span>    }</div>
<div class="line"><span class="lineno">  323</span>    <span class="keywordflow">if</span> (alignment == 0 || (alignment &amp; (alignment - 1)) != 0)</div>
<div class="line"><span class="lineno">  324</span>    {</div>
<div class="line"><span class="lineno">  325</span>        <a class="code hl_function" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;%s failed: alignment (%zu) is not a power-of-two&quot;</span>, label, alignment);</div>
<div class="line"><span class="lineno">  326</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  327</span>    }</div>
<div class="line"><span class="lineno">  328</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  329</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__debug_8c_source.html#l00253">arena_report_error()</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__alloc_8c_source.html#l00721">arena_alloc_internal()</a>.</p>

</div>
</div>
<a id="ga2e295157296ca7e9d2450486f2e817e0" name="ga2e295157296ca7e9d2450486f2e817e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2e295157296ca7e9d2450486f2e817e0">&#9670;&#160;</a></span>arena_calc_aligned_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t arena_calc_aligned_offset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alignment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__alloc_8c.html">arena_alloc.c</a>&gt;</code></p>

<p>Compute the next aligned offset within the arena. </p>
<p>This helper calculates the next available offset within the arena's buffer that satisfies the specified alignment requirement. It adds the current offset to the base buffer address, rounds the result up to the nearest aligned address, and then subtracts the base address to return the aligned offset.</p>
<p>This value is used to ensure that allocations start at properly aligned memory locations, which is essential for performance and correctness on many platforms.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena structure. </td></tr>
    <tr><td class="paramname">alignment</td><td>The desired alignment (must be a power of two).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The aligned offset (relative to the buffer base).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arena__internal.html#ga2e09625e200e30dafcb85771b821a355" title="Align a value upwards to the nearest multiple of alignment.">align_up</a> </dd>
<dd>
<a class="el" href="group__arena__alloc__internal.html#gaeb6bc4f71524a7a594b0e248eb0dbda0" title="Ensure that the arena has enough space for a new allocation with alignment.">arena_ensure_capacity</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_alloc_8c-example.html#a7">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_alloc.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__alloc_8c_source.html#l00422">422</a> of file <a class="el" href="arena__alloc_8c_source.html">arena_alloc.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  423</span>{</div>
<div class="line"><span class="lineno">  424</span>    <span class="keywordtype">size_t</span> curr    = (size_t) (arena-&gt;buffer + arena-&gt;offset);</div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordtype">size_t</span> aligned = <a class="code hl_function" href="group__arena__internal.html#ga2e09625e200e30dafcb85771b821a355">align_up</a>(curr, alignment);</div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">return</span> aligned - (size_t) arena-&gt;buffer;</div>
<div class="line"><span class="lineno">  427</span>}</div>
<div class="ttc" id="agroup__arena__internal_html_ga2e09625e200e30dafcb85771b821a355"><div class="ttname"><a href="group__arena__internal.html#ga2e09625e200e30dafcb85771b821a355">align_up</a></div><div class="ttdeci">static size_t align_up(size_t value, size_t alignment)</div><div class="ttdoc">Align a value upwards to the nearest multiple of alignment.</div><div class="ttdef"><b>Definition</b> <a href="arena__math_8h_source.html#l00052">arena_math.h:52</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__math_8h_source.html#l00052">align_up()</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__alloc_8c_source.html#l00503">arena_ensure_capacity()</a>.</p>

</div>
</div>
<a id="ga6f9b8799f6f53e294ff5368b6cca60cf" name="ga6f9b8799f6f53e294ff5368b6cca60cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6f9b8799f6f53e294ff5368b6cca60cf">&#9670;&#160;</a></span>arena_check_overflow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool arena_check_overflow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__alloc_8c.html">arena_alloc.c</a>&gt;</code></p>

<p>Check whether an allocation would cause a size_t overflow. </p>
<p>This helper ensures that the requested allocation does not exceed the bounds of the addressable memory space by checking for integer overflow when adding <code>size</code> to the current <code>arena-&gt;offset</code>.</p>
<p>If an overflow would occur, the function:</p><ul>
<li>Increments the <code>failed_allocations</code> counter in the arena stats.</li>
<li>Logs an error message with the given <code>label</code>.</li>
<li>Returns <code>true</code> to indicate failure.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena being used for allocation. </td></tr>
    <tr><td class="paramname">size</td><td>The requested allocation size in bytes. </td></tr>
    <tr><td class="paramname">label</td><td>Label or name of the calling function for error context.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if an overflow would occur, <code>false</code> otherwise.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arena__alloc__internal.html#ga133779294340b3b7b1353e5e41870855" title="Core internal allocator with alignment and labeling support.">arena_alloc_internal</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_alloc_8c-example.html#a6">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_alloc.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__alloc_8c_source.html#l00388">388</a> of file <a class="el" href="arena__alloc_8c_source.html">arena_alloc.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  389</span>{</div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordflow">if</span> (size &gt; SIZE_MAX - arena-&gt;offset)</div>
<div class="line"><span class="lineno">  391</span>    {</div>
<div class="line"><span class="lineno">  392</span>        arena-&gt;stats.failed_allocations++;</div>
<div class="line"><span class="lineno">  393</span>        <a class="code hl_function" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;%s failed: size overflow (requested: %zu)&quot;</span>, label, size);</div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  395</span>    }</div>
<div class="line"><span class="lineno">  396</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  397</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__debug_8c_source.html#l00253">arena_report_error()</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__alloc_8c_source.html#l00721">arena_alloc_internal()</a>.</p>

</div>
</div>
<a id="ga9f456348bfdf8040dd8d3fbf26bfd4fa" name="ga9f456348bfdf8040dd8d3fbf26bfd4fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9f456348bfdf8040dd8d3fbf26bfd4fa">&#9670;&#160;</a></span>arena_commit_allocation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void arena_commit_allocation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>wasted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>aligned_offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__alloc_8c.html">arena_alloc.c</a>&gt;</code></p>

<p>Update offset, peak usage, and statistics. </p>
<p>This internal helper is used after determining that an allocation can safely be performed. It updates the arena's <code>offset</code> to reflect the new allocation, invokes <code><a class="el" href="group__arena__internal.html#gaa3a1838aa18111801b980c0b81e37813" title="Update the peak usage metric of the arena.">arena_update_peak()</a></code> to track maximum usage, and updates internal statistics such as allocation count, total allocated bytes, and alignment waste via <code><a class="el" href="group__arena__alloc__internal.html#gac58e6becbc80f328dce1ad2ecf17c2f0" title="Update allocation statistics after a successful arena allocation.">arena_update_stats()</a></code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena being updated. </td></tr>
    <tr><td class="paramname">size</td><td>Size in bytes of the allocation. </td></tr>
    <tr><td class="paramname">wasted</td><td>Number of alignment bytes wasted. </td></tr>
    <tr><td class="paramname">aligned_offset</td><td>Offset where the allocation begins in the buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function assumes that allocation boundaries and capacity have already been validated via <code><a class="el" href="group__arena__alloc__internal.html#gaeb6bc4f71524a7a594b0e248eb0dbda0" title="Ensure that the arena has enough space for a new allocation with alignment.">arena_ensure_capacity()</a></code>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arena__alloc__internal.html#ga133779294340b3b7b1353e5e41870855" title="Core internal allocator with alignment and labeling support.">arena_alloc_internal</a> </dd>
<dd>
<a class="el" href="group__arena__alloc__internal.html#gac58e6becbc80f328dce1ad2ecf17c2f0" title="Update allocation statistics after a successful arena allocation.">arena_update_stats</a> </dd>
<dd>
<a class="el" href="group__arena__internal.html#gaa3a1838aa18111801b980c0b81e37813" title="Update the peak usage metric of the arena.">arena_update_peak</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_alloc_8c-example.html#a11">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_alloc.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__alloc_8c_source.html#l00593">593</a> of file <a class="el" href="arena__alloc_8c_source.html">arena_alloc.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  594</span>{</div>
<div class="line"><span class="lineno">  595</span>    arena-&gt;offset = aligned_offset + size;</div>
<div class="line"><span class="lineno">  596</span>    <a class="code hl_function" href="group__arena__internal.html#gaa3a1838aa18111801b980c0b81e37813">arena_update_peak</a>(arena);</div>
<div class="line"><span class="lineno">  597</span>    <a class="code hl_function" href="group__arena__alloc__internal.html#gac58e6becbc80f328dce1ad2ecf17c2f0">arena_update_stats</a>(arena, size, wasted);</div>
<div class="line"><span class="lineno">  598</span>}</div>
<div class="ttc" id="agroup__arena__alloc__internal_html_gac58e6becbc80f328dce1ad2ecf17c2f0"><div class="ttname"><a href="group__arena__alloc__internal.html#gac58e6becbc80f328dce1ad2ecf17c2f0">arena_update_stats</a></div><div class="ttdeci">static void arena_update_stats(t_arena *arena, size_t size, size_t wasted)</div><div class="ttdoc">Update allocation statistics after a successful arena allocation.</div><div class="ttdef"><b>Definition</b> <a href="arena__alloc_8c_source.html#l00551">arena_alloc.c:551</a></div></div>
<div class="ttc" id="agroup__arena__internal_html_gaa3a1838aa18111801b980c0b81e37813"><div class="ttname"><a href="group__arena__internal.html#gaa3a1838aa18111801b980c0b81e37813">arena_update_peak</a></div><div class="ttdeci">void arena_update_peak(t_arena *arena)</div><div class="ttdoc">Update the peak usage metric of the arena.</div><div class="ttdef"><b>Definition</b> <a href="arena__internal_8c_source.html#l00118">arena_internal.c:118</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__internal_8c_source.html#l00118">arena_update_peak()</a>, and <a class="el" href="arena__alloc_8c_source.html#l00551">arena_update_stats()</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__alloc_8c_source.html#l00721">arena_alloc_internal()</a>.</p>

</div>
</div>
<a id="gaeb6bc4f71524a7a594b0e248eb0dbda0" name="gaeb6bc4f71524a7a594b0e248eb0dbda0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeb6bc4f71524a7a594b0e248eb0dbda0">&#9670;&#160;</a></span>arena_ensure_capacity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool arena_ensure_capacity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>aligned_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>wasted</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__alloc_8c.html">arena_alloc.c</a>&gt;</code></p>

<p>Ensure that the arena has enough space for a new allocation with alignment. </p>
<p>This function calculates the aligned offset needed to satisfy an allocation of <code>size</code> bytes with the given <code>alignment</code>. If the allocation fits in the current arena buffer, the function returns <code>true</code>.</p>
<p>If the buffer is too small and the arena is allowed to grow, it attempts to expand the buffer via <code><a class="el" href="group__arena__alloc__internal.html#ga9c0ddb62aa03ce8395bf6937ebf2a766" title="Attempt to grow the arena&#39;s buffer to satisfy an upcoming allocation.">arena_try_grow()</a></code>, and then recalculates the offset and checks again.</p>
<p>This function returns:</p><ul>
<li><code>true</code> if enough space is available (after optional growth).</li>
<li><code>false</code> if the arena cannot grow or is still too small.</li>
</ul>
<p>The final aligned offset and wasted bytes (padding due to alignment) are written to the provided output pointers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena being used. </td></tr>
    <tr><td class="paramname">size</td><td>Size of the requested allocation (in bytes). </td></tr>
    <tr><td class="paramname">alignment</td><td>Required alignment (must be power-of-two). </td></tr>
    <tr><td class="paramname">label</td><td>Label for logging and error reporting. </td></tr>
    <tr><td class="paramname">aligned_offset</td><td>Output: aligned offset where the allocation would start. </td></tr>
    <tr><td class="paramname">wasted</td><td>Output: number of bytes wasted due to alignment padding.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if capacity is sufficient, <code>false</code> otherwise.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arena__alloc__internal.html#ga2e295157296ca7e9d2450486f2e817e0" title="Compute the next aligned offset within the arena.">arena_calc_aligned_offset</a> </dd>
<dd>
<a class="el" href="group__arena__alloc__internal.html#ga9c0ddb62aa03ce8395bf6937ebf2a766" title="Attempt to grow the arena&#39;s buffer to satisfy an upcoming allocation.">arena_try_grow</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_alloc_8c-example.html#a9">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_alloc.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__alloc_8c_source.html#l00503">503</a> of file <a class="el" href="arena__alloc_8c_source.html">arena_alloc.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  505</span>{</div>
<div class="line"><span class="lineno">  506</span>    *aligned_offset = <a class="code hl_function" href="group__arena__alloc__internal.html#ga2e295157296ca7e9d2450486f2e817e0">arena_calc_aligned_offset</a>(arena, alignment);</div>
<div class="line"><span class="lineno">  507</span>    *wasted         = *aligned_offset - arena-&gt;offset;</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordflow">if</span> (*aligned_offset + size &lt;= arena-&gt;size)</div>
<div class="line"><span class="lineno">  510</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="group__arena__alloc__internal.html#ga9c0ddb62aa03ce8395bf6937ebf2a766">arena_try_grow</a>(arena, size, label))</div>
<div class="line"><span class="lineno">  513</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>    *aligned_offset = <a class="code hl_function" href="group__arena__alloc__internal.html#ga2e295157296ca7e9d2450486f2e817e0">arena_calc_aligned_offset</a>(arena, alignment);</div>
<div class="line"><span class="lineno">  516</span>    *wasted         = *aligned_offset - arena-&gt;offset;</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>    <span class="keywordflow">return</span> *aligned_offset + size &lt;= arena-&gt;size;</div>
<div class="line"><span class="lineno">  519</span>}</div>
<div class="ttc" id="agroup__arena__alloc__internal_html_ga2e295157296ca7e9d2450486f2e817e0"><div class="ttname"><a href="group__arena__alloc__internal.html#ga2e295157296ca7e9d2450486f2e817e0">arena_calc_aligned_offset</a></div><div class="ttdeci">static size_t arena_calc_aligned_offset(t_arena *arena, size_t alignment)</div><div class="ttdoc">Compute the next aligned offset within the arena.</div><div class="ttdef"><b>Definition</b> <a href="arena__alloc_8c_source.html#l00422">arena_alloc.c:422</a></div></div>
<div class="ttc" id="agroup__arena__alloc__internal_html_ga9c0ddb62aa03ce8395bf6937ebf2a766"><div class="ttname"><a href="group__arena__alloc__internal.html#ga9c0ddb62aa03ce8395bf6937ebf2a766">arena_try_grow</a></div><div class="ttdeci">static bool arena_try_grow(t_arena *arena, size_t size, const char *label)</div><div class="ttdoc">Attempt to grow the arena's buffer to satisfy an upcoming allocation.</div><div class="ttdef"><b>Definition</b> <a href="arena__alloc_8c_source.html#l00454">arena_alloc.c:454</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__alloc_8c_source.html#l00422">arena_calc_aligned_offset()</a>, and <a class="el" href="arena__alloc_8c_source.html#l00454">arena_try_grow()</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__alloc_8c_source.html#l00721">arena_alloc_internal()</a>.</p>

</div>
</div>
<a id="ga8f2b15d641638478af17012c9af5044e" name="ga8f2b15d641638478af17012c9af5044e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8f2b15d641638478af17012c9af5044e">&#9670;&#160;</a></span>arena_invoke_allocation_hook()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void arena_invoke_allocation_hook </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>wasted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__alloc_8c.html">arena_alloc.c</a>&gt;</code></p>

<p>Invoke the user-defined allocation hook, if registered. </p>
<p>This internal utility checks whether an allocation hook has been registered in the arenas debug hook system (<code>arena-&gt;hooks.hook_cb</code>). If a hook is set, it is called with detailed allocation metadata:</p>
<ul>
<li>Arena pointer</li>
<li>Allocation ID</li>
<li>Pointer to the allocated memory</li>
<li>Size of the allocation</li>
<li>Offset in the arena buffer</li>
<li>Wasted bytes due to alignment</li>
<li>Allocation label</li>
</ul>
<p>The hook is loaded using <code>atomic_load_explicit</code> to ensure safe concurrent access. This mechanism enables advanced users to track allocations (e.g., for profiling, leak detection, or debugging).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena that performed the allocation. </td></tr>
    <tr><td class="paramname">ptr</td><td>Pointer to the allocated memory block. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes allocated. </td></tr>
    <tr><td class="paramname">offset</td><td>Offset in the arena buffer where the allocation began. </td></tr>
    <tr><td class="paramname">wasted</td><td>Number of wasted bytes due to alignment padding. </td></tr>
    <tr><td class="paramname">label</td><td>Label associated with this allocation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>If no hook is set, this function does nothing.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arena__alloc.html#ga049a09c0c438a1e77064022a9c26fd46" title="Set a custom allocation hook for the given arena.">arena_set_allocation_hook</a> </dd>
<dd>
<a class="el" href="group__arena__alloc__internal.html#ga133779294340b3b7b1353e5e41870855" title="Core internal allocator with alignment and labeling support.">arena_alloc_internal</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_alloc_8c-example.html#a13">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_alloc.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__alloc_8c_source.html#l00672">672</a> of file <a class="el" href="arena__alloc_8c_source.html">arena_alloc.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  674</span>{</div>
<div class="line"><span class="lineno">  675</span>    <a class="code hl_typedef" href="arena__hooks_8h.html#af00a46507125773d89254554a8eedc74">arena_allocation_hook</a> hook = atomic_load_explicit(&amp;arena-&gt;hooks.hook_cb, memory_order_acquire);</div>
<div class="line"><span class="lineno">  676</span>    <span class="keywordflow">if</span> (hook)</div>
<div class="line"><span class="lineno">  677</span>        hook(arena, (<span class="keywordtype">int</span>) arena-&gt;stats.alloc_id_counter, ptr, size, offset, wasted, label);</div>
<div class="line"><span class="lineno">  678</span>}</div>
<div class="ttc" id="aarena__hooks_8h_html_af00a46507125773d89254554a8eedc74"><div class="ttname"><a href="arena__hooks_8h.html#af00a46507125773d89254554a8eedc74">arena_allocation_hook</a></div><div class="ttdeci">void(* arena_allocation_hook)(t_arena *arena, int alloc_id, void *ptr, size_t size, size_t offset, size_t wasted, const char *label)</div><div class="ttdoc">Allocation hook callback type.</div><div class="ttdef"><b>Definition</b> <a href="arena__hooks_8h_source.html#l00058">arena_hooks.h:58</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="arena__alloc_8c_source.html#l00721">arena_alloc_internal()</a>.</p>

</div>
</div>
<a id="ga4860119335c3c686269e4912018ce72f" name="ga4860119335c3c686269e4912018ce72f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4860119335c3c686269e4912018ce72f">&#9670;&#160;</a></span>arena_is_being_destroyed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool arena_is_being_destroyed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__alloc_8c.html">arena_alloc.c</a>&gt;</code></p>

<p>Check whether the arena is currently being destroyed. </p>
<p>This internal helper inspects the <code>is_destroying</code> atomic flag to determine whether the arena is in the process of being torn down (e.g., via <code><a class="el" href="arena_8h.html#a640f54190aa0b356bc55787bfde1dcc5">arena_destroy()</a></code>).</p>
<p>If the flag is set, an error is reported with the provided <code>label</code>, and the function returns <code>true</code> to indicate that no further operations should be performed on the arena.</p>
<p>This check prevents undefined behavior and race conditions by avoiding memory access or mutation while destruction is in progress.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena being queried. </td></tr>
    <tr><td class="paramname">label</td><td>Name of the calling function, used for contextual error messages.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the arena is being destroyed, <code>false</code> otherwise.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="arena_8h.html#a640f54190aa0b356bc55787bfde1dcc5">arena_destroy</a> </dd>
<dd>
<a class="el" href="group__arena__alloc__internal.html#ga133779294340b3b7b1353e5e41870855" title="Core internal allocator with alignment and labeling support.">arena_alloc_internal</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_alloc_8c-example.html#a5">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_alloc.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__alloc_8c_source.html#l00356">356</a> of file <a class="el" href="arena__alloc_8c_source.html">arena_alloc.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  357</span>{</div>
<div class="line"><span class="lineno">  358</span>    (void)label;</div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordflow">if</span> (atomic_load_explicit(&amp;arena-&gt;is_destroying, memory_order_acquire))</div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  362</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="arena__alloc_8c_source.html#l00721">arena_alloc_internal()</a>.</p>

</div>
</div>
<a id="ga59787ca32537e09f2b7bb6087540d35a" name="ga59787ca32537e09f2b7bb6087540d35a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga59787ca32537e09f2b7bb6087540d35a">&#9670;&#160;</a></span>arena_realloc_validate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool arena_realloc_validate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>old_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>new_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__realloc__last_8c.html">arena_realloc_last.c</a>&gt;</code></p>

<p>Validate input arguments for <code>arena_realloc_last</code>. </p>
<p>This internal helper checks that the inputs to <code>arena_realloc_last</code> are valid before proceeding with reallocation logic. It ensures:</p>
<ul>
<li>The <code>arena</code> pointer is not <code>NULL</code>.</li>
<li>The <code>old_ptr</code> is not <code>NULL</code>.</li>
<li>The <code>new_size</code> is greater than zero.</li>
</ul>
<p>If any check fails, a descriptive error is reported using <code><a class="el" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error()</a></code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena where the reallocation is performed. </td></tr>
    <tr><td class="paramname">old_ptr</td><td>Pointer to the previously allocated memory. </td></tr>
    <tr><td class="paramname">new_size</td><td>New size requested for the reallocation (in bytes).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if inputs are valid, <code>false</code> otherwise.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="arena__realloc__last_8c.html#a6c647c686994ff6f760d3590696c0976">arena_realloc_last</a> </dd>
<dd>
<a class="el" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_realloc_last_8c-example.html#a5">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_realloc_last.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__realloc__last_8c_source.html#l00167">167</a> of file <a class="el" href="arena__realloc__last_8c_source.html">arena_realloc_last.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  168</span>{</div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">if</span> (!arena)</div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(NULL, <span class="stringliteral">&quot;arena_realloc_last failed: NULL arena&quot;</span>), <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  171</span>    <span class="keywordflow">if</span> (!old_ptr)</div>
<div class="line"><span class="lineno">  172</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;arena_realloc_last failed: NULL old_ptr&quot;</span>), <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">if</span> (new_size == 0)</div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;arena_realloc_last failed: zero-size reallocation&quot;</span>), <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  176</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__debug_8c_source.html#l00253">arena_report_error()</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__realloc__last_8c_source.html#l00122">arena_realloc_last()</a>.</p>

</div>
</div>
<a id="ga9c0ddb62aa03ce8395bf6937ebf2a766" name="ga9c0ddb62aa03ce8395bf6937ebf2a766"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9c0ddb62aa03ce8395bf6937ebf2a766">&#9670;&#160;</a></span>arena_try_grow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool arena_try_grow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__alloc_8c.html">arena_alloc.c</a>&gt;</code></p>

<p>Attempt to grow the arena's buffer to satisfy an upcoming allocation. </p>
<p>This internal helper checks whether the arena is allowed to grow (<code>can_grow</code> flag) and, if so, attempts to expand its memory region by calling <code><a class="el" href="arena_8h.html#a223081ace38b33a46cc1ed0eaadf867f">arena_grow()</a></code>.</p>
<p>If growth is disallowed or fails, an appropriate error is reported with the given label for context, and the function returns <code>false</code>.</p>
<p>This function helps support dynamic allocation models where the arena is allowed to resize its memory buffer when out of space.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena to grow. </td></tr>
    <tr><td class="paramname">size</td><td>Minimum number of bytes required to satisfy the next allocation. </td></tr>
    <tr><td class="paramname">label</td><td>Allocation label used for context in error messages.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if growth succeeded or was unnecessary, <code>false</code> otherwise.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="arena_8h.html#a223081ace38b33a46cc1ed0eaadf867f">arena_grow</a> </dd>
<dd>
<a class="el" href="group__arena__alloc__internal.html#gaeb6bc4f71524a7a594b0e248eb0dbda0" title="Ensure that the arena has enough space for a new allocation with alignment.">arena_ensure_capacity</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_alloc_8c-example.html#a8">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_alloc.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__alloc_8c_source.html#l00454">454</a> of file <a class="el" href="arena__alloc_8c_source.html">arena_alloc.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  455</span>{</div>
<div class="line"><span class="lineno">  456</span>    <span class="keywordflow">if</span> (!arena-&gt;can_grow)</div>
<div class="line"><span class="lineno">  457</span>    {</div>
<div class="line"><span class="lineno">  458</span>        <a class="code hl_function" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;%s failed: cannot grow&quot;</span>, label);</div>
<div class="line"><span class="lineno">  459</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  460</span>    }</div>
<div class="line"><span class="lineno">  461</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="arena_8h.html#a223081ace38b33a46cc1ed0eaadf867f">arena_grow</a>(arena, size))</div>
<div class="line"><span class="lineno">  462</span>    {</div>
<div class="line"><span class="lineno">  463</span>        <a class="code hl_function" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;%s failed: growth failed&quot;</span>, label);</div>
<div class="line"><span class="lineno">  464</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  465</span>    }</div>
<div class="line"><span class="lineno">  466</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  467</span>}</div>
<div class="ttc" id="aarena_8h_html_a223081ace38b33a46cc1ed0eaadf867f"><div class="ttname"><a href="arena_8h.html#a223081ace38b33a46cc1ed0eaadf867f">arena_grow</a></div><div class="ttdeci">bool arena_grow(t_arena *arena, size_t required_size)</div><div class="ttdef"><b>Definition</b> <a href="arena__resize_8c_source.html#l00142">arena_resize.c:142</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__resize_8c_source.html#l00142">arena_grow()</a>, and <a class="el" href="arena__debug_8c_source.html#l00253">arena_report_error()</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__alloc_8c_source.html#l00503">arena_ensure_capacity()</a>.</p>

</div>
</div>
<a id="gac58e6becbc80f328dce1ad2ecf17c2f0" name="gac58e6becbc80f328dce1ad2ecf17c2f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac58e6becbc80f328dce1ad2ecf17c2f0">&#9670;&#160;</a></span>arena_update_stats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void arena_update_stats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>wasted</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__alloc_8c.html">arena_alloc.c</a>&gt;</code></p>

<p>Update allocation statistics after a successful arena allocation. </p>
<p>This function increments and records key allocation-related statistics inside the <code>arena-&gt;stats</code> structure. These statistics include:</p><ul>
<li>Total number of allocations (<code>allocations</code>)</li>
<li>Current number of live allocations (<code>live_allocations</code>)</li>
<li>Total number of bytes allocated (<code>bytes_allocated</code>)</li>
<li>Total number of wasted bytes due to alignment (<code>wasted_alignment_bytes</code>)</li>
<li>Last allocation size (<code>last_alloc_size</code>)</li>
<li>Offset of the last allocation (<code>last_alloc_offset</code>)</li>
<li>Allocation ID counter (<code>alloc_id_counter</code>)</li>
</ul>
<p>The stats are updated inside a critical section to ensure thread safety when <code>ARENA_ENABLE_THREAD_SAFE</code> is enabled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena whose statistics are to be updated. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes allocated. </td></tr>
    <tr><td class="paramname">wasted</td><td>Number of bytes wasted due to alignment padding.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function performs locking internally (via <code>ARENA_LOCK</code> / <code>ARENA_UNLOCK</code>), so it should not be called within an existing locked section to avoid deadlocks.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arena__alloc__internal.html#ga9f456348bfdf8040dd8d3fbf26bfd4fa" title="Update offset, peak usage, and statistics.">arena_commit_allocation</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_alloc_8c-example.html#a10">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_alloc.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__alloc_8c_source.html#l00551">551</a> of file <a class="el" href="arena__alloc_8c_source.html">arena_alloc.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  552</span>{</div>
<div class="line"><span class="lineno">  553</span>    <span class="keywordflow">if</span> (!arena)</div>
<div class="line"><span class="lineno">  554</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>    <a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>(arena);</div>
<div class="line"><span class="lineno">  557</span>    arena-&gt;stats.allocations++;</div>
<div class="line"><span class="lineno">  558</span>    arena-&gt;stats.live_allocations++;</div>
<div class="line"><span class="lineno">  559</span>    arena-&gt;stats.bytes_allocated += size;</div>
<div class="line"><span class="lineno">  560</span>    arena-&gt;stats.wasted_alignment_bytes += wasted;</div>
<div class="line"><span class="lineno">  561</span>    arena-&gt;stats.alloc_id_counter++;</div>
<div class="line"><span class="lineno">  562</span>    arena-&gt;stats.last_alloc_size   = size;</div>
<div class="line"><span class="lineno">  563</span>    arena-&gt;stats.last_alloc_offset = arena-&gt;offset - size;</div>
<div class="line"><span class="lineno">  564</span>    <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line"><span class="lineno">  565</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__internal_8h_source.html#l00061">ARENA_LOCK</a>, and <a class="el" href="arena__internal_8h_source.html#l00062">ARENA_UNLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__alloc_8c_source.html#l00593">arena_commit_allocation()</a>.</p>

</div>
</div>
<a id="gad3e406beb730e9664468c0ca3ba8ec3e" name="gad3e406beb730e9664468c0ca3ba8ec3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad3e406beb730e9664468c0ca3ba8ec3e">&#9670;&#160;</a></span>arena_zero_if_needed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void arena_zero_if_needed </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__alloc_8c.html">arena_alloc.c</a>&gt;</code></p>

<p>Zero or poison a memory region depending on allocation label. </p>
<p>This internal utility determines whether a newly allocated block of memory should be zero-initialized or poisoned for debugging purposes.</p>
<p>If the provided <code>label</code> is exactly <code>"arena_calloc_zero"</code>, the memory is cleared using <code>memset(ptr, 0, size)</code>. Otherwise, the memory is poisoned using <code><a class="el" href="arena__debug_8h.html#a904e1da25faaab32ade91d8232c60364" title="No-op poison macro when poisoning is disabled.">arena_poison_memory()</a></code> to help detect uninitialized access in debugging mode.</p>
<p>This is typically used in <code><a class="el" href="group__arena__alloc__internal.html#ga133779294340b3b7b1353e5e41870855" title="Core internal allocator with alignment and labeling support.">arena_alloc_internal()</a></code> after computing the memory location of a new allocation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Pointer to the memory block to initialize. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes to initialize. </td></tr>
    <tr><td class="paramname">label</td><td>Allocation label string used to determine behavior.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The label comparison is string-based; other labels will trigger poisoning in debug mode.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arena__alloc__internal.html#ga133779294340b3b7b1353e5e41870855" title="Core internal allocator with alignment and labeling support.">arena_alloc_internal</a> </dd>
<dd>
<a class="el" href="arena__debug_8h.html#a904e1da25faaab32ade91d8232c60364" title="No-op poison macro when poisoning is disabled.">arena_poison_memory</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_alloc_8c-example.html#a12">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_alloc.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__alloc_8c_source.html#l00628">628</a> of file <a class="el" href="arena__alloc_8c_source.html">arena_alloc.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  629</span>{</div>
<div class="line"><span class="lineno">  630</span>    <span class="keywordflow">if</span> (label &amp;&amp; strcmp(label, <span class="stringliteral">&quot;arena_calloc_zero&quot;</span>) == 0)</div>
<div class="line"><span class="lineno">  631</span>        memset(ptr, 0, size);</div>
<div class="line"><span class="lineno">  632</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  633</span>        <a class="code hl_define" href="arena__debug_8h.html#a904e1da25faaab32ade91d8232c60364">arena_poison_memory</a>(ptr, size);</div>
<div class="line"><span class="lineno">  634</span>}</div>
<div class="ttc" id="aarena__debug_8h_html_a904e1da25faaab32ade91d8232c60364"><div class="ttname"><a href="arena__debug_8h.html#a904e1da25faaab32ade91d8232c60364">arena_poison_memory</a></div><div class="ttdeci">#define arena_poison_memory(ptr, size)</div><div class="ttdoc">No-op poison macro when poisoning is disabled.</div><div class="ttdef"><b>Definition</b> <a href="arena__debug_8h_source.html#l00334">arena_debug.h:334</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__debug_8h_source.html#l00334">arena_poison_memory</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__alloc_8c_source.html#l00721">arena_alloc_internal()</a>.</p>

</div>
</div>
<a id="ga7344d4d188eb129d3d35a47a46569d1e" name="ga7344d4d188eb129d3d35a47a46569d1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7344d4d188eb129d3d35a47a46569d1e">&#9670;&#160;</a></span>is_last_allocation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool is_last_allocation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>old_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>old_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__realloc__last_8c.html">arena_realloc_last.c</a>&gt;</code></p>

<p>Check if a given pointer corresponds to the most recent allocation. </p>
<p>This helper determines whether <code>old_ptr</code> is the last allocation made by the arena. It does so by comparing the pointer to the expected end of the buffer based on <code>arena-&gt;offset</code> and the known <code>old_size</code>.</p>
<p>This check is necessary before attempting an in-place reallocation, as only the last allocation can be safely resized in place.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena. </td></tr>
    <tr><td class="paramname">old_ptr</td><td>Pointer to the memory block to check. </td></tr>
    <tr><td class="paramname">old_size</td><td>Size of the previously allocated memory block.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if <code>old_ptr</code> is the last allocation, <code>false</code> otherwise.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="arena__realloc__last_8c.html#a6c647c686994ff6f760d3590696c0976">arena_realloc_last</a> </dd>
<dd>
<a class="el" href="group__arena__alloc__internal.html#ga2d7433d074678a86dbeae84e99ac8f94" title="Attempt to resize the last allocation in place.">realloc_in_place</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_realloc_last_8c-example.html#a6">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_realloc_last.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__realloc__last_8c_source.html#l00201">201</a> of file <a class="el" href="arena__realloc__last_8c_source.html">arena_realloc_last.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  202</span>{</div>
<div class="line"><span class="lineno">  203</span>    uint8_t* expected = arena-&gt;buffer + (arena-&gt;offset - old_size);</div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">return</span> (uint8_t*) old_ptr == expected;</div>
<div class="line"><span class="lineno">  205</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="arena__realloc__last_8c_source.html#l00122">arena_realloc_last()</a>.</p>

</div>
</div>
<a id="ga5f5f39015c38a0eb93f501a0aac30904" name="ga5f5f39015c38a0eb93f501a0aac30904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5f5f39015c38a0eb93f501a0aac30904">&#9670;&#160;</a></span>realloc_fallback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * realloc_fallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>old_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>old_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>new_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__realloc__last_8c.html">arena_realloc_last.c</a>&gt;</code></p>

<p>Perform a fallback reallocation by allocating new memory and copying data. </p>
<p>This internal function is used when <code><a class="el" href="arena__realloc__last_8c.html#a6c647c686994ff6f760d3590696c0976">arena_realloc_last()</a></code> cannot perform an in-place reallocation (e.g., when the old pointer is not the last allocation).</p>
<p>It performs the following steps:</p><ul>
<li>Allocates a new memory block of <code>new_size</code> bytes.</li>
<li>Copies <code>min(old_size, new_size)</code> bytes from the old block to the new block.</li>
<li>Poisons the old memory region for debugging purposes.</li>
<li>Updates internal reallocation statistics and invokes the allocation hook, if set.</li>
</ul>
<p>This approach ensures consistent tracking of memory usage even when in-place reallocation is not possible.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena from which to allocate new memory. </td></tr>
    <tr><td class="paramname">old_ptr</td><td>Pointer to the original memory block. </td></tr>
    <tr><td class="paramname">old_size</td><td>Size of the original allocation. </td></tr>
    <tr><td class="paramname">new_size</td><td>Desired size of the new allocation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the newly allocated memory block, or <code>NULL</code> on failure.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="arena__realloc__last_8c.html#a6c647c686994ff6f760d3590696c0976">arena_realloc_last</a> </dd>
<dd>
<a class="el" href="group__arena__alloc__internal.html#ga2d7433d074678a86dbeae84e99ac8f94" title="Attempt to resize the last allocation in place.">realloc_in_place</a> </dd>
<dd>
<a class="el" href="group__arena__alloc__internal.html#gaf5e38e7a826283f488841979faec9f00" title="Update arena statistics after a successful reallocation.">update_realloc_stats</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_realloc_last_8c-example.html#a9">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_realloc_last.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__realloc__last_8c_source.html#l00330">330</a> of file <a class="el" href="arena__realloc__last_8c_source.html">arena_realloc_last.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  331</span>{</div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordtype">void</span>* new_ptr = <a class="code hl_function" href="arena_8h.html#a1def00c6156e8df19f0a1af7cd6f26dd">arena_alloc</a>(arena, new_size);</div>
<div class="line"><span class="lineno">  333</span>    <span class="keywordflow">if</span> (!new_ptr)</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>    memcpy(new_ptr, old_ptr, old_size &lt; new_size ? old_size : new_size);</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>    <a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>(arena);</div>
<div class="line"><span class="lineno">  339</span>    <a class="code hl_define" href="arena__debug_8h.html#a904e1da25faaab32ade91d8232c60364">arena_poison_memory</a>(old_ptr, old_size);</div>
<div class="line"><span class="lineno">  340</span>    <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>(arena);</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>    <a class="code hl_function" href="group__arena__alloc__internal.html#gaf5e38e7a826283f488841979faec9f00">update_realloc_stats</a>(arena, new_ptr, new_size, old_size, <span class="stringliteral">&quot;arena_realloc_last (fallback)&quot;</span>);</div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordflow">return</span> new_ptr;</div>
<div class="line"><span class="lineno">  344</span>}</div>
<div class="ttc" id="aarena_8h_html_a1def00c6156e8df19f0a1af7cd6f26dd"><div class="ttname"><a href="arena_8h.html#a1def00c6156e8df19f0a1af7cd6f26dd">arena_alloc</a></div><div class="ttdeci">void * arena_alloc(t_arena *arena, size_t size)</div><div class="ttdef"><b>Definition</b> <a href="arena__alloc_8c_source.html#l00112">arena_alloc.c:112</a></div></div>
<div class="ttc" id="agroup__arena__alloc__internal_html_gaf5e38e7a826283f488841979faec9f00"><div class="ttname"><a href="group__arena__alloc__internal.html#gaf5e38e7a826283f488841979faec9f00">update_realloc_stats</a></div><div class="ttdeci">static void update_realloc_stats(t_arena *arena, void *ptr, size_t new_size, size_t old_size, const char *label)</div><div class="ttdoc">Update arena statistics after a successful reallocation.</div><div class="ttdef"><b>Definition</b> <a href="arena__realloc__last_8c_source.html#l00236">arena_realloc_last.c:236</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__alloc_8c_source.html#l00112">arena_alloc()</a>, <a class="el" href="arena__internal_8h_source.html#l00061">ARENA_LOCK</a>, <a class="el" href="arena__debug_8h_source.html#l00334">arena_poison_memory</a>, <a class="el" href="arena__internal_8h_source.html#l00062">ARENA_UNLOCK</a>, and <a class="el" href="arena__realloc__last_8c_source.html#l00236">update_realloc_stats()</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__realloc__last_8c_source.html#l00122">arena_realloc_last()</a>.</p>

</div>
</div>
<a id="ga2d7433d074678a86dbeae84e99ac8f94" name="ga2d7433d074678a86dbeae84e99ac8f94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2d7433d074678a86dbeae84e99ac8f94">&#9670;&#160;</a></span>realloc_in_place()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * realloc_in_place </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>old_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>old_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>new_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__realloc__last_8c.html">arena_realloc_last.c</a>&gt;</code></p>

<p>Attempt to resize the last allocation in place. </p>
<p>This internal function resizes the most recent allocation made by the arena, assuming that <code>old_ptr</code> points to the last allocated block.</p>
<p>If the new size extends beyond the current buffer capacity, it attempts to grow the arena using <code><a class="el" href="arena_8h.html#a223081ace38b33a46cc1ed0eaadf867f">arena_grow()</a></code>. If growth fails, the function reports an error and returns <code>NULL</code>.</p>
<p>If the new size is smaller than the original, the unused tail of the allocation is poisoned to help catch accidental use of stale memory in debug mode.</p>
<p>The function updates internal statistics and triggers the allocation hook with the <code>"arena_realloc_last (in-place)"</code> label to reflect the successful resize.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena managing the memory. </td></tr>
    <tr><td class="paramname">old_ptr</td><td>Pointer to the memory block being reallocated. </td></tr>
    <tr><td class="paramname">old_size</td><td>Size of the current allocation in bytes. </td></tr>
    <tr><td class="paramname">new_size</td><td>Desired new size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>old_ptr</code> if the resize succeeded in place, or <code>NULL</code> on failure.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="arena_8h.html#a223081ace38b33a46cc1ed0eaadf867f">arena_grow</a> </dd>
<dd>
<a class="el" href="group__arena__alloc__internal.html#gaf5e38e7a826283f488841979faec9f00" title="Update arena statistics after a successful reallocation.">update_realloc_stats</a> </dd>
<dd>
<a class="el" href="arena__realloc__last_8c.html#a6c647c686994ff6f760d3590696c0976">arena_realloc_last</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_realloc_last_8c-example.html#a8">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_realloc_last.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__realloc__last_8c_source.html#l00284">284</a> of file <a class="el" href="arena__realloc__last_8c_source.html">arena_realloc_last.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  285</span>{</div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordtype">size_t</span> new_end = arena-&gt;offset - old_size + new_size;</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <span class="keywordflow">if</span> (new_end &gt; arena-&gt;size &amp;&amp; !<a class="code hl_function" href="arena_8h.html#a223081ace38b33a46cc1ed0eaadf867f">arena_grow</a>(arena, new_size - old_size))</div>
<div class="line"><span class="lineno">  289</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="arena__debug_8h.html#ad19e051bc49dc6b6dcda0f31561e222d">arena_report_error</a>(arena, <span class="stringliteral">&quot;arena_realloc_last failed: growth failed (needed %zu bytes)&quot;</span>,</div>
<div class="line"><span class="lineno">  290</span>                                  new_size - old_size),</div>
<div class="line"><span class="lineno">  291</span>               NULL;</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    <span class="keywordflow">if</span> (new_size &lt; old_size)</div>
<div class="line"><span class="lineno">  294</span>        <a class="code hl_define" href="arena__debug_8h.html#a904e1da25faaab32ade91d8232c60364">arena_poison_memory</a>((uint8_t*) old_ptr + new_size, old_size - new_size);</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    <a class="code hl_function" href="group__arena__alloc__internal.html#gaf5e38e7a826283f488841979faec9f00">update_realloc_stats</a>(arena, old_ptr, new_size, old_size, <span class="stringliteral">&quot;arena_realloc_last (in-place)&quot;</span>);</div>
<div class="line"><span class="lineno">  297</span>    <span class="keywordflow">return</span> old_ptr;</div>
<div class="line"><span class="lineno">  298</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__resize_8c_source.html#l00142">arena_grow()</a>, <a class="el" href="arena__debug_8h_source.html#l00334">arena_poison_memory</a>, <a class="el" href="arena__debug_8c_source.html#l00253">arena_report_error()</a>, and <a class="el" href="arena__realloc__last_8c_source.html#l00236">update_realloc_stats()</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__realloc__last_8c_source.html#l00122">arena_realloc_last()</a>.</p>

</div>
</div>
<a id="gaf5e38e7a826283f488841979faec9f00" name="gaf5e38e7a826283f488841979faec9f00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf5e38e7a826283f488841979faec9f00">&#9670;&#160;</a></span>update_realloc_stats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void update_realloc_stats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>new_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>old_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arena__realloc__last_8c.html">arena_realloc_last.c</a>&gt;</code></p>

<p>Update arena statistics after a successful reallocation. </p>
<p>This internal helper updates the arena's internal state to reflect a successful in-place reallocation. It performs the following:</p><ul>
<li>Adjusts the <code>offset</code> to account for the new allocation size.</li>
<li>Updates peak usage via <code><a class="el" href="group__arena__internal.html#gaa3a1838aa18111801b980c0b81e37813" title="Update the peak usage metric of the arena.">arena_update_peak()</a></code>.</li>
<li>Increments allocation-related counters.</li>
<li>Records metadata about the last allocation (size, offset).</li>
<li>Triggers the allocation hook if one is registered.</li>
</ul>
<p>This function is used exclusively during in-place reallocation, where the existing memory block remains valid and grows or shrinks.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arena</td><td>Pointer to the arena being updated. </td></tr>
    <tr><td class="paramname">ptr</td><td>Pointer to the reallocated memory block. </td></tr>
    <tr><td class="paramname">new_size</td><td>New size of the allocation (in bytes). </td></tr>
    <tr><td class="paramname">old_size</td><td>Previous size of the allocation (in bytes). </td></tr>
    <tr><td class="paramname">label</td><td>Descriptive label for logging and tracking.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arena__alloc__internal.html#ga2d7433d074678a86dbeae84e99ac8f94" title="Attempt to resize the last allocation in place.">realloc_in_place</a> </dd>
<dd>
<a class="el" href="group__arena__alloc__internal.html#ga5f5f39015c38a0eb93f501a0aac30904" title="Perform a fallback reallocation by allocating new memory and copying data.">realloc_fallback</a> </dd>
<dd>
<a class="el" href="arena__realloc__last_8c.html#a6c647c686994ff6f760d3590696c0976">arena_realloc_last</a> </dd>
<dd>
<a class="el" href="group__arena__internal.html#gaa3a1838aa18111801b980c0b81e37813" title="Update the peak usage metric of the arena.">arena_update_peak</a> </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2allocation_2arena_realloc_last_8c-example.html#a7">/home/toonsa/myProjects/memoryArena/srcs/core/allocation/arena_realloc_last.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__realloc__last_8c_source.html#l00236">236</a> of file <a class="el" href="arena__realloc__last_8c_source.html">arena_realloc_last.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  237</span>{</div>
<div class="line"><span class="lineno">  238</span>    arena-&gt;offset = (uint8_t*) ptr + new_size - arena-&gt;buffer;</div>
<div class="line"><span class="lineno">  239</span>    <a class="code hl_function" href="group__arena__internal.html#gaa3a1838aa18111801b980c0b81e37813">arena_update_peak</a>(arena);</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>    arena-&gt;stats.reallocations++;</div>
<div class="line"><span class="lineno">  242</span>    arena-&gt;stats.live_allocations++;</div>
<div class="line"><span class="lineno">  243</span>    arena-&gt;stats.bytes_allocated += (new_size - old_size);</div>
<div class="line"><span class="lineno">  244</span>    arena-&gt;stats.last_alloc_size   = new_size;</div>
<div class="line"><span class="lineno">  245</span>    arena-&gt;stats.last_alloc_offset = (size_t) ((uint8_t*) ptr - arena-&gt;buffer);</div>
<div class="line"><span class="lineno">  246</span>    arena-&gt;stats.alloc_id_counter++;</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordflow">if</span> (arena-&gt;hooks.hook_cb)</div>
<div class="line"><span class="lineno">  249</span>        arena-&gt;hooks.hook_cb(arena, (<span class="keywordtype">int</span>) arena-&gt;stats.alloc_id_counter, ptr, new_size, arena-&gt;stats.last_alloc_offset,</div>
<div class="line"><span class="lineno">  250</span>                             0, label);</div>
<div class="line"><span class="lineno">  251</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__internal_8c_source.html#l00118">arena_update_peak()</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__realloc__last_8c_source.html#l00330">realloc_fallback()</a>, and <a class="el" href="arena__realloc__last_8c_source.html#l00284">realloc_in_place()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
