<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>memory_arena: arena_io.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">memory_arena
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">arena_io.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Arena snapshot input/output operations (save/load).  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="arena_8h_source.html">arena.h</a>&quot;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for arena_io.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="arena__io_8h__incl.png" border="0" usemap="#aarena__io_8h" alt=""/></div>
<map name="aarena__io_8h" id="aarena__io_8h">
<area shape="rect" title="Arena snapshot input/output operations (save/load)." alt="" coords="889,5,980,31"/>
<area shape="rect" href="arena_8h.html" title="Core public API for the Arena memory allocator." alt="" coords="741,79,811,104"/>
<area shape="poly" title=" " alt="" coords="910,33,815,75,813,71,908,28"/>
<area shape="rect" title=" " alt="" coords="735,225,817,251"/>
<area shape="poly" title=" " alt="" coords="959,28,1004,54,1051,91,1069,112,1081,134,1082,157,1071,179,1055,192,1031,203,968,220,897,230,831,236,831,231,896,225,967,214,1030,198,1052,188,1067,176,1077,156,1076,135,1065,115,1047,95,1001,59,956,33"/>
<area shape="rect" title=" " alt="" coords="891,152,962,177"/>
<area shape="poly" title=" " alt="" coords="801,102,891,144,888,148,799,106"/>
<area shape="rect" title=" " alt="" coords="986,152,1057,177"/>
<area shape="poly" title=" " alt="" coords="812,100,973,147,972,152,811,106"/>
<area shape="rect" href="arena__debug_8h.html" title="Debugging utilities and hooks for the arena memory allocator." alt="" coords="163,152,335,177"/>
<area shape="poly" title=" " alt="" coords="741,100,348,153,347,148,740,95"/>
<area shape="rect" href="arena__hooks_8h.html" title="Allocation hook system for arena&#45;based memory tracking and introspection." alt="" coords="16,152,133,177"/>
<area shape="poly" title=" " alt="" coords="741,98,494,119,151,155,147,155,147,150,150,149,493,114,740,93"/>
<area shape="rect" href="arena__internal_8h.html" title="Internal utilities and helpers for arena memory management." alt="" coords="685,152,867,177"/>
<area shape="poly" title=" " alt="" coords="772,104,770,139,765,138,766,104"/>
<area shape="rect" href="arena__math_8h.html" title="Math utility functions for memory alignment and overflow&#45;safe arithmetic." alt="" coords="494,152,661,177"/>
<area shape="poly" title=" " alt="" coords="745,107,624,150,622,145,743,102"/>
<area shape="rect" href="arena__stats_8h.html" title="Runtime statistics tracking and diagnostics for memory arenas." alt="" coords="359,152,470,177"/>
<area shape="poly" title=" " alt="" coords="741,102,484,152,483,147,740,97"/>
<area shape="rect" href="arena__config_8h.html" title=" " alt="" coords="128,225,245,251"/>
<area shape="poly" title=" " alt="" coords="241,179,208,217,204,213,237,176"/>
<area shape="rect" title=" " alt="" coords="269,225,344,251"/>
<area shape="poly" title=" " alt="" coords="261,176,291,213,287,216,257,179"/>
<area shape="rect" title=" " alt="" coords="5,225,104,251"/>
<area shape="poly" title=" " alt="" coords="219,180,100,223,98,218,217,175"/>
<area shape="rect" title=" " alt="" coords="555,225,629,251"/>
<area shape="poly" title=" " alt="" coords="308,175,542,222,541,228,307,180"/>
<area shape="rect" title=" " alt="" coords="459,225,530,251"/>
<area shape="poly" title=" " alt="" coords="289,175,447,220,446,225,288,180"/>
<area shape="rect" title=" " alt="" coords="368,225,435,251"/>
<area shape="poly" title=" " alt="" coords="275,175,365,217,363,222,273,180"/>
<area shape="poly" title=" " alt="" coords="74,178,64,213,59,211,69,177"/>
<area shape="poly" title=" " alt="" coords="780,152,782,118,787,118,786,152"/>
<area shape="poly" title=" " alt="" coords="747,180,636,223,634,218,745,175"/>
<area shape="poly" title=" " alt="" coords="779,178,779,212,773,212,773,178"/>
<area shape="poly" title=" " alt="" coords="582,177,589,211,584,212,577,178"/>
<area shape="poly" title=" " alt="" coords="566,179,520,218,517,214,562,175"/>
<area shape="poly" title=" " alt="" coords="610,175,731,218,730,223,608,180"/>
<area shape="poly" title=" " alt="" coords="444,175,552,218,550,223,442,180"/>
<area shape="poly" title=" " alt="" coords="415,178,409,212,403,211,410,177"/>
</map>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="arena__io_8h__dep__incl.png" border="0" usemap="#aarena__io_8hdep" alt=""/></div>
<map name="aarena__io_8hdep" id="aarena__io_8hdep">
<area shape="rect" title="Arena snapshot input/output operations (save/load)." alt="" coords="5,5,96,31"/>
<area shape="rect" href="arena__io_8c.html" title="Arena snapshot serialization and deserialization." alt="" coords="6,79,95,104"/>
<area shape="poly" title=" " alt="" coords="53,44,53,79,48,79,48,44"/>
</map>
</div>
</div>
<p><a href="arena__io_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structs__arena__snapshot__header.html">s_arena_snapshot_header</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Header structure prepended to saved arena snapshots.  <a href="structs__arena__snapshot__header.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af2975ccb90fd1ce2adcef695ff16c475" id="r_af2975ccb90fd1ce2adcef695ff16c475"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arena__io_8h.html#af2975ccb90fd1ce2adcef695ff16c475">ARENA_SNAPSHOT_MAGIC</a>&#160;&#160;&#160;&quot;ARENASNAP&quot;</td></tr>
<tr class="memdesc:af2975ccb90fd1ce2adcef695ff16c475"><td class="mdescLeft">&#160;</td><td class="mdescRight">Magic string identifying a valid arena snapshot file.  <br /></td></tr>
<tr class="separator:af2975ccb90fd1ce2adcef695ff16c475"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab6d688bb8dc4b19071614bff97b58f8" id="r_aab6d688bb8dc4b19071614bff97b58f8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arena__io_8h.html#aab6d688bb8dc4b19071614bff97b58f8">ARENA_SNAPSHOT_VERSION</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:aab6d688bb8dc4b19071614bff97b58f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Version number of the snapshot file format.  <br /></td></tr>
<tr class="separator:aab6d688bb8dc4b19071614bff97b58f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa1710210a6b8eca29c71eb46b01b51e4" id="r_aa1710210a6b8eca29c71eb46b01b51e4"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structs__arena__snapshot__header.html">s_arena_snapshot_header</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arena__io_8h.html#aa1710210a6b8eca29c71eb46b01b51e4">__attribute__</a> ((packed)) t_arena_snapshot_header</td></tr>
<tr class="memdesc:aa1710210a6b8eca29c71eb46b01b51e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Header structure prepended to saved arena snapshots.  <br /></td></tr>
<tr class="separator:aa1710210a6b8eca29c71eb46b01b51e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf8617fba731d0f3cd2421ccaca9206b" id="r_abf8617fba731d0f3cd2421ccaca9206b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arena__io_8h.html#abf8617fba731d0f3cd2421ccaca9206b">arena_load_from_file</a> (<a class="el" href="structt__arena.html">t_arena</a> *arena, const char *path)</td></tr>
<tr class="separator:abf8617fba731d0f3cd2421ccaca9206b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a301654434865dfe084792622514c0af3" id="r_a301654434865dfe084792622514c0af3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arena__io_8h.html#a301654434865dfe084792622514c0af3">arena_save_to_file</a> (const <a class="el" href="structt__arena.html">t_arena</a> *arena, const char *path)</td></tr>
<tr class="separator:a301654434865dfe084792622514c0af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a59b41703a2d2d07b87ccd5a99c48f0fa" id="r_a59b41703a2d2d07b87ccd5a99c48f0fa"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arena__io_8h.html#a59b41703a2d2d07b87ccd5a99c48f0fa">magic</a> [9]</td></tr>
<tr class="memdesc:a59b41703a2d2d07b87ccd5a99c48f0fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Magic string ("ARENASNAP\0")  <br /></td></tr>
<tr class="separator:a59b41703a2d2d07b87ccd5a99c48f0fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8cc011bf3ee2d3c19743095ffc0f7a5" id="r_ae8cc011bf3ee2d3c19743095ffc0f7a5"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a></td></tr>
<tr class="memdesc:ae8cc011bf3ee2d3c19743095ffc0f7a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes used in the arena buffer.  <br /></td></tr>
<tr class="separator:ae8cc011bf3ee2d3c19743095ffc0f7a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd99bb05ca015e7d74448acb1deba7ca" id="r_acd99bb05ca015e7d74448acb1deba7ca"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arena__io_8h.html#acd99bb05ca015e7d74448acb1deba7ca">version</a></td></tr>
<tr class="memdesc:acd99bb05ca015e7d74448acb1deba7ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Snapshot file format version.  <br /></td></tr>
<tr class="separator:acd99bb05ca015e7d74448acb1deba7ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Arena snapshot input/output operations (save/load). </p>
<dl class="section author"><dt>Author</dt><dd>Toonsa </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2025</dd></dl>
<p>This header declares functions to serialize and deserialize the memory contents of an arena. These operations allow arenas to be saved to disk and restored later, enabling features such as state persistence, debugging snapshots, or offline replay.</p>
<p>The snapshot includes a compact header (<code>t_arena_snapshot_header</code>) followed by the raw used memory buffer of the arena.</p>
<ul>
<li><code><a class="el" href="arena__io_8h.html#a301654434865dfe084792622514c0af3">arena_save_to_file()</a></code> writes the arena's used memory to a file.</li>
<li><code><a class="el" href="arena__io_8h.html#abf8617fba731d0f3cd2421ccaca9206b">arena_load_from_file()</a></code> restores the memory contents from a file into an existing arena.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>These functions are meant for single-threaded or externally synchronized use. They assume the arena is not being mutated during I/O. </dd></dl>

<p class="definition">Definition in file <a class="el" href="arena__io_8h_source.html">arena_io.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="af2975ccb90fd1ce2adcef695ff16c475" name="af2975ccb90fd1ce2adcef695ff16c475"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2975ccb90fd1ce2adcef695ff16c475">&#9670;&#160;</a></span>ARENA_SNAPSHOT_MAGIC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARENA_SNAPSHOT_MAGIC&#160;&#160;&#160;&quot;ARENASNAP&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Magic string identifying a valid arena snapshot file. </p>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2arena_io_8c-example.html#a9">/home/toonsa/myProjects/memoryArena/srcs/core/arena_io.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__io_8h_source.html#l00034">34</a> of file <a class="el" href="arena__io_8h_source.html">arena_io.h</a>.</p>

</div>
</div>
<a id="aab6d688bb8dc4b19071614bff97b58f8" name="aab6d688bb8dc4b19071614bff97b58f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab6d688bb8dc4b19071614bff97b58f8">&#9670;&#160;</a></span>ARENA_SNAPSHOT_VERSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARENA_SNAPSHOT_VERSION&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Version number of the snapshot file format. </p>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2arena_io_8c-example.html#a10">/home/toonsa/myProjects/memoryArena/srcs/core/arena_io.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__io_8h_source.html#l00037">37</a> of file <a class="el" href="arena__io_8h_source.html">arena_io.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa1710210a6b8eca29c71eb46b01b51e4" name="aa1710210a6b8eca29c71eb46b01b51e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1710210a6b8eca29c71eb46b01b51e4">&#9670;&#160;</a></span>__attribute__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structs__arena__snapshot__header.html">s_arena_snapshot_header</a> __attribute__ </td>
          <td>(</td>
          <td class="paramtype">(packed)&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Header structure prepended to saved arena snapshots. </p>
<p>This packed structure contains metadata about a saved arena buffer, including:</p><ul>
<li>A magic string for format verification.</li>
<li>A version field for compatibility checks.</li>
<li>The number of bytes used in the saved arena.</li>
</ul>
<p>This header is written/read before the actual memory contents of the arena. </p>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2include_2arena_io_8h-example.html#a9">/home/toonsa/myProjects/memoryArena/include/arena_io.h</a>.</dd>
</dl>

</div>
</div>
<a id="abf8617fba731d0f3cd2421ccaca9206b" name="abf8617fba731d0f3cd2421ccaca9206b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf8617fba731d0f3cd2421ccaca9206b">&#9670;&#160;</a></span>arena_load_from_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool arena_load_from_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2include_2arena_io_8h-example.html#a10">/home/toonsa/myProjects/memoryArena/include/arena_io.h</a>, and <a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2arena_io_8c-example.html#a5">/home/toonsa/myProjects/memoryArena/srcs/core/arena_io.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__io_8c_source.html#l00114">114</a> of file <a class="el" href="arena__io_8c_source.html">arena_io.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  115</span>{</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">if</span> (!arena || !path)</div>
<div class="line"><span class="lineno">  117</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordflow">if</span> (!atomic_load_explicit(&amp;arena-&gt;owns_buffer, memory_order_acquire))</div>
<div class="line"><span class="lineno">  120</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    FILE* f = fopen(path, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><span class="lineno">  123</span>    <span class="keywordflow">if</span> (!f)</div>
<div class="line"><span class="lineno">  124</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    t_arena_snapshot_header header;</div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordtype">bool</span> ok = fread(&amp;header, <span class="keyword">sizeof</span>(header), 1, f) == 1 &amp;&amp; strncmp(header.magic, <a class="code hl_define" href="arena__io_8h.html#af2975ccb90fd1ce2adcef695ff16c475">ARENA_SNAPSHOT_MAGIC</a>, 9) == 0 &amp;&amp;</div>
<div class="line"><span class="lineno">  128</span>              header.version == <a class="code hl_define" href="arena__io_8h.html#aab6d688bb8dc4b19071614bff97b58f8">ARENA_SNAPSHOT_VERSION</a> &amp;&amp; header.used &lt;= arena-&gt;size &amp;&amp;</div>
<div class="line"><span class="lineno">  129</span>              fread(arena-&gt;buffer, 1, header.used, f) == header.used;</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">if</span> (ok)</div>
<div class="line"><span class="lineno">  132</span>        arena-&gt;offset = header.used;</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>    fclose(f);</div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">return</span> ok;</div>
<div class="line"><span class="lineno">  136</span>}</div>
<div class="ttc" id="aarena__io_8h_html_aab6d688bb8dc4b19071614bff97b58f8"><div class="ttname"><a href="arena__io_8h.html#aab6d688bb8dc4b19071614bff97b58f8">ARENA_SNAPSHOT_VERSION</a></div><div class="ttdeci">#define ARENA_SNAPSHOT_VERSION</div><div class="ttdoc">Version number of the snapshot file format.</div><div class="ttdef"><b>Definition</b> <a href="arena__io_8h_source.html#l00037">arena_io.h:37</a></div></div>
<div class="ttc" id="aarena__io_8h_html_af2975ccb90fd1ce2adcef695ff16c475"><div class="ttname"><a href="arena__io_8h.html#af2975ccb90fd1ce2adcef695ff16c475">ARENA_SNAPSHOT_MAGIC</a></div><div class="ttdeci">#define ARENA_SNAPSHOT_MAGIC</div><div class="ttdoc">Magic string identifying a valid arena snapshot file.</div><div class="ttdef"><b>Definition</b> <a href="arena__io_8h_source.html#l00034">arena_io.h:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__io_8h_source.html#l00034">ARENA_SNAPSHOT_MAGIC</a>, and <a class="el" href="arena__io_8h_source.html#l00037">ARENA_SNAPSHOT_VERSION</a>.</p>

</div>
</div>
<a id="a301654434865dfe084792622514c0af3" name="a301654434865dfe084792622514c0af3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a301654434865dfe084792622514c0af3">&#9670;&#160;</a></span>arena_save_to_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool arena_save_to_file </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structt__arena.html">t_arena</a> *&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2include_2arena_io_8h-example.html#a4">/home/toonsa/myProjects/memoryArena/include/arena_io.h</a>, and <a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2arena_io_8c-example.html#a4">/home/toonsa/myProjects/memoryArena/srcs/core/arena_io.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__io_8c_source.html#l00089">89</a> of file <a class="el" href="arena__io_8c_source.html">arena_io.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   90</span>{</div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordflow">if</span> (!arena || !path)</div>
<div class="line"><span class="lineno">   92</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">if</span> (!atomic_load_explicit(&amp;arena-&gt;owns_buffer, memory_order_acquire))</div>
<div class="line"><span class="lineno">   95</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    <a class="code hl_define" href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a>((<a class="code hl_struct" href="structt__arena.html">t_arena</a>*) arena);</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordtype">size_t</span>      <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a> = arena-&gt;offset;</div>
<div class="line"><span class="lineno">   99</span>    <span class="keyword">const</span> <span class="keywordtype">void</span>* buf  = arena-&gt;buffer;</div>
<div class="line"><span class="lineno">  100</span>    <a class="code hl_define" href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a>((<a class="code hl_struct" href="structt__arena.html">t_arena</a>*) arena);</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    t_arena_snapshot_header header = {.magic = <a class="code hl_define" href="arena__io_8h.html#af2975ccb90fd1ce2adcef695ff16c475">ARENA_SNAPSHOT_MAGIC</a>, .version = <a class="code hl_define" href="arena__io_8h.html#aab6d688bb8dc4b19071614bff97b58f8">ARENA_SNAPSHOT_VERSION</a>, .used = <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>};</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    FILE* f = fopen(path, <span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">if</span> (!f)</div>
<div class="line"><span class="lineno">  106</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordtype">bool</span> ok = fwrite(&amp;header, <span class="keyword">sizeof</span>(header), 1, f) == 1 &amp;&amp; fwrite(buf, 1, <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>, f) == <a class="code hl_variable" href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>;</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    fclose(f);</div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">return</span> ok;</div>
<div class="line"><span class="lineno">  112</span>}</div>
<div class="ttc" id="aarena__internal_8h_html_a22d9551decc1373f55ceb93bcd8b27a3"><div class="ttname"><a href="arena__internal_8h.html#a22d9551decc1373f55ceb93bcd8b27a3">ARENA_UNLOCK</a></div><div class="ttdeci">#define ARENA_UNLOCK(arena)</div><div class="ttdef"><b>Definition</b> <a href="arena__internal_8h_source.html#l00062">arena_internal.h:62</a></div></div>
<div class="ttc" id="aarena__internal_8h_html_a5aca30bebc88f9c38377ff61521b3796"><div class="ttname"><a href="arena__internal_8h.html#a5aca30bebc88f9c38377ff61521b3796">ARENA_LOCK</a></div><div class="ttdeci">#define ARENA_LOCK(arena)</div><div class="ttdoc">Acquire the mutex lock if thread safety is enabled.</div><div class="ttdef"><b>Definition</b> <a href="arena__internal_8h_source.html#l00061">arena_internal.h:61</a></div></div>
<div class="ttc" id="aarena__io_8h_html_ae8cc011bf3ee2d3c19743095ffc0f7a5"><div class="ttname"><a href="arena__io_8h.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a></div><div class="ttdeci">size_t used</div><div class="ttdoc">Number of bytes used in the arena buffer.</div><div class="ttdef"><b>Definition</b> <a href="arena__io_8h_source.html#l00002">arena_io.h:2</a></div></div>
<div class="ttc" id="astructt__arena_html"><div class="ttname"><a href="structt__arena.html">t_arena</a></div><div class="ttdoc">The main memory arena structure used for fast allocation.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="arena__internal_8h_source.html#l00061">ARENA_LOCK</a>, <a class="el" href="arena__io_8h_source.html#l00034">ARENA_SNAPSHOT_MAGIC</a>, <a class="el" href="arena__io_8h_source.html#l00037">ARENA_SNAPSHOT_VERSION</a>, <a class="el" href="arena__internal_8h_source.html#l00062">ARENA_UNLOCK</a>, and <a class="el" href="arena__io_8h_source.html#l00002">used</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a59b41703a2d2d07b87ccd5a99c48f0fa" name="a59b41703a2d2d07b87ccd5a99c48f0fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59b41703a2d2d07b87ccd5a99c48f0fa">&#9670;&#160;</a></span>magic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char magic[9]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Magic string ("ARENASNAP\0") </p>

<p class="definition">Definition at line <a class="el" href="arena__io_8h_source.html#l00000">0</a> of file <a class="el" href="arena__io_8h_source.html">arena_io.h</a>.</p>

</div>
</div>
<a id="ae8cc011bf3ee2d3c19743095ffc0f7a5" name="ae8cc011bf3ee2d3c19743095ffc0f7a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8cc011bf3ee2d3c19743095ffc0f7a5">&#9670;&#160;</a></span>used</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t used</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of bytes used in the arena buffer. </p>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2toonsa_2myProjects_2memoryArena_2srcs_2core_2arena_io_8c-example.html#a7">/home/toonsa/myProjects/memoryArena/srcs/core/arena_io.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="arena__io_8h_source.html#l00002">2</a> of file <a class="el" href="arena__io_8h_source.html">arena_io.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="arena__resize_8c_source.html#l00108">arena_might_shrink()</a>, <a class="el" href="arena__io_8c_source.html#l00089">arena_save_to_file()</a>, <a class="el" href="arena__resize_8c_source.html#l00511">arena_should_maybe_shrink()</a>, <a class="el" href="arena__resize_8c_source.html#l00542">arena_shrink_target()</a>, <a class="el" href="arena__state_8c_source.html#l00035">arena_used()</a>, and <a class="el" href="arena__visualizer_8c_source.html#l00089">draw_visualizer()</a>.</p>

</div>
</div>
<a id="acd99bb05ca015e7d74448acb1deba7ca" name="acd99bb05ca015e7d74448acb1deba7ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd99bb05ca015e7d74448acb1deba7ca">&#9670;&#160;</a></span>version</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t version</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Snapshot file format version. </p>

<p class="definition">Definition at line <a class="el" href="arena__io_8h_source.html#l00001">1</a> of file <a class="el" href="arena__io_8h_source.html">arena_io.h</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
